---
aliases: ["1964267376613214199"]
title: DATEADD函数
created: 2025-07-29
modified: 2025-07-29
tags: ['ESB中心']
theme: ESB中心
---

#### 一、功能背景及价值

在项目管理、财务计算、合同管理等业务场景中，经常需要对日期进行加减计算。DATEADD函数提供灵活的日期加减计算功能，支持多种时间单位的精确计算，并可选工作日模式，大幅提升日期计算的效率和准确性。此时用户便可通过数据上报、流程等模块中的表单设计器直接来为字段配置对应函数公式，也可通过字段联动来设置赋值字段并选择对应函数公式为其赋值。

#### 二、功能概述及使用说明

DATEADD函数支持对日期/时间进行加减运算，可指定不同时间单位，并支持工作日计算模式。

1. 语法介绍

DATEADD(日期, 数值, [单位], [日期累加类型])

1.参数介绍

必选参数：日期（支持常量和变量，支持标准日期时间格式或字段）

必选参数：数字（支持常量和变量，数字可为正数（加）或负数（减））

可选参数：单位（支持年Y、月M、日D、时H、分I、秒S ，不填时默认为日D）

可选参数：日期累加类型(默认为空,可选参数:'W'(按工作日进行正数累加或负数累减,仅适用于单位为'D'时)

返回值：日期时间字符串（格式与输入保持一致）。

|  |  |  |  |  |
| --- | --- | --- | --- | --- |
| **参数** | **必选/可选** | **说明** | **可选值** | **默认值** |
| **日期** | 必选 | 基准日期/时间 | 标准日期时间格式或字段 | - |
| **数值** | 必选 | 要加减的数值 | 正数（加）或负数（减） | - |
| **单位** | 可选 | 时间单位 | 'Y'(年)/'M'(月)/'D'(日)/'H'(时)/'I'(分)/'S'(秒) | 'D' |
| **累加累减类型** | 可选 | 特殊计算类型 | 'W'(工作日) | 空 |

3.参数详细说明

3.1单位参数详解

|  |  |  |
| --- | --- | --- |
| **单位** | **说明** | **示例** |
| 'Y' | 按年加减 | DATEADD('2025-01-01', 1, 'Y') → '2026-01-01' |
| 'M' | 按月加减 | DATEADD('2025-01-31', 1, 'M') → '2025-02-28' |
| 'D' | 按日加减 | DATEADD('2025-01-01', 7, 'D') → '2025-01-08' |
| 'H' | 按小时加减 | DATEADD('2025-01-01 12:00', 3, 'H') → '2025-01-01 15:00' |
| 'I' | 按分钟加减 | DATEADD('2025-01-01 12:00', 30, 'I') → '2025-01-01 12:30' |
| 'S' | 按秒加减 | DATEADD('2025-01-01 12:00:00', 45, 'S') → '2025-01-01 12:00:45' |

3.2工作日模式说明

1.仅当单位为'D'时有效

2.自动跳过周末（周六、周日）

3.不考虑法定节假日

示例：DATEADD('2025-05-02'(周五), 3, 'D', 'W') → '2025-05-08'(周四)

#### 三、场景示例

1.基本日期加减

**场景**：计算合同到期日（签订日+1年）

合同签订日、合同到期日都是日期字段，合同签定日的值为2025年5月6日，增加1年，数值填写1，单位填写'Y'，函数公式为：

合同到期日=DATEADD({签约合同.合同签订日},1,'Y')

便可计算出函数结果，合同到期日=2026-05-06

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/48934eec71c57f3b3d7a1739664e5634.jpg)

2.复杂计算

**场景**：计算合同到期日为合同签订日基础上加6个月减1天

合同签订日、合同到期日都是日期字段，合同签定日的值为2025年5月6日，增加6个月减1天，因为这里涉及到月和日，所以需要使用2次DATEADD函数。函数公式为：

{签约合同.合同到期日}=DATEADD(DATEADD({签约合同.合同签订日},6,'M'),-1,'D')

函数结果为：{签约合同.合同到期日}=2025-11-05

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/629deec9caacc69b98d7ef61fd01dc9f.jpg)

3.工作日计算

**场景**：计算3个工作日后的日期

合同签订日、合同到期日都是日期字段，当合同签订日为2025年5月23日时是周五，添加3个工作日会跳过24号（周六）、25号（周日），函数公式如下：

{签约合同.合同到期日}=DATEADD({签约合同.合同签订日},3,'D','W')

函数结果为：{签约合同.合同到期日}=2025-05-28

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/323e627765789bca3e1c71fa1cd6ff42.jpg)

2.使用该功能的注意点

1.计算的结果可以赋值给日期字段，也可以赋值给单行文本字段。

2.单位区分大写小，一定要是大写（年Y、月M、日D、时H、分I、秒S ）。

