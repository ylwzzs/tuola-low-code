---
aliases: ["1975341084087675015"]
title: NETWORKDAYSPI
created: 2025-07-29
modified: 2025-07-29
tags: ['ESB中心']
theme: ESB中心
---

#### 一、功能背景及价值

在人力资源、项目管理、薪酬计算等场景中，经常需要精确计算特定人员在指定时间段内的工作日天数。NETWORKDAYSPI函数提供智能化的工作日计算功能，支持按考勤制度或法定工作日计算，并可精确到小时/分钟，大幅提升考勤统计和工时计算的准确性。此时用户便可通过数据上报、流程等模块中的表单设计器直接来为字段配置对应函数公式，也可通过字段联动来设置赋值字段并选择对应函数公式为其赋值。

点击查看日期函数整体介绍

#### 二、功能概述及使用说明

NETWORKDAYSPI函数用于计算两个日期之间的工作日天数，支持两种计算模式：

考勤制度模式（A）：基于人员具体考勤规则

法定模式（S）：基于国家法定工作日

1. 语法介绍

NETWORKDAYSPI(日期1, 日期2, 人员, [类型], [单位])

查询类型为'A'时，即按考勤制度查询，将截止当前日期之前（支持选到当前日期，最大支持跨度为365天）的所选时间段内包含的工作日天数返回。  
注意:此函数只能选择过去的时间（可选到当前日期）才可使用，跨度不能超过365天。查询类型为'S'时，即按法定查询，没有限制。当日期2小于日期1时，差值为负值。单位默认为日。

2.参数介绍

必选参数：日期1（支持常量、变量，支持标准日期时间格式或字段）

必选参数：日期2（支持常量、变量，支持标准日期时间格式或字段）

必选参数：人员（支持人员变量或{U:姓名}格式）

可选参数：类型（'A'(考勤制度)/'S'(法定)，默认'A'）

可选参数：单位（支持'D'(天)/'H'(小时)/'I'(分钟)，默认'D'）

返回值：数值型的工作日数量（日期2 - 日期1，可为负值）

|  |  |  |  |  |
| --- | --- | --- | --- | --- |
| **参数** | **必选/可选** | **说明** | **可选值** | **默认值** |
| **日期1** | 必选 | 开始日期 | 标准日期格式 | - |
| **日期2** | 必选 | 结束日期 | 标准日期格式 | - |
| **人员** | 必选 | 人员标识 | 人员变量或{U:姓名}格式 | - |
| **类型** | 可选 | 计算模式 | 'A'(考勤制度)/'S'(法定) | 'A' |
| **单位** | 可选 | 结果单位 | 'D'(天)/'H'(小时)/'I'(分钟) | 'D' |

3.计算模式详解

3.1考勤制度模式（'A'）

根据人员所属考勤组规则计算

自动排除：

周末（可配置大小周）

个人请假/调休

考勤组特殊休息日

**限制**：

只能查询过去日期（含当天）

最大时间跨度365天

3.2.法定模式（'S'）

基于国家法定节假日安排

自动排除：

周末双休日

法定节假日

调休工作日

**优势**：

可查询任意时间段

无时间跨度限制

#### 三、场景示例

1.考勤统计（默认模式）

**场景**：计算张三2025年4月实际出勤天数（假设当月无请假）

考勤天数是数字字段，此时函数公式便为：

考勤天数=NETWORKDAYSPI('2025-04-01','2025-04-30',{U:张三})

便可计算得出考勤天数=22天。

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/6741e20c4dd75a2d72b7ddc975873599.jpg)

2.项目工时计算

**场景**：计算李四参与项目的有效工时（小时）

开始时间、结束时间都是日期字段（年月日时分秒格式），值分为别为：2025-04-01 10:44:14、2025-04-04 16:44:32。考勤天数是数字字段，结果是24个小时（3天\*8个小时），与开始时间、结束时间的时具体是多少无关。函数公式为：

{考勤表.考勤天数}=NETWORKDAYSPI({考勤表.开始时间},{考勤表.结束时间},{U:李四},'A','H')

函数公式结果：{考勤表.考勤天数}=24.00

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/b0df02c4a130b822a33a3fda4ef0addc.jpg)

3.法定工作日查询

**场景**：计算2025年国庆假期后的法定工作日

考勤天数是数字字段，'2025-10-07'之间'2025-10-13'只有9、10、11、13号是工作日，所以最后法定工作日是4天。函数公式为：

{考勤表.考勤天数}=NETWORKDAYSPI('2025-10-07','2025-10-13',{系统参数.当前用户},'S')

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/c2516cb6afe4eed555cce874373977f3.jpg)

### 四、使用该功能的注意点

1.类型区分大写小写，一定要是大写（法定S，默认A ）。

