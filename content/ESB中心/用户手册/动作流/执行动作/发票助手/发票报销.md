---
aliases: ["1970556417800102357"]
title: 发票报销
created: 2025-07-29
modified: 2025-07-29
tags: ['ESB中心']
theme: ESB中心
---

**一、作用**

1、使用新表单创建的流程报销单，支持在esb中心搭建动作流， 进行发票报销。

2、历史报销单支持使用原有的报销设置

## 二、前期准备

团队开通esb动作流 ，如图

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/60a898a1cc21166b332a1919d9d3dc85.jpg)

## 三、操作步骤

#### 3.1、 新建表单

在系统的【工作流程】或 【电子费控】模块 新建团队工作流， 表单中要包含电子发票控件 ， 金额控件，金额钻取电子发票控件的价税合计

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/4d66f724d2b8817773e17a365216f696.jpg)

#### 3.2、发票报销动作流配置

进入后台管理中心，点击ESB中心

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/d68fd29dd9089ed62ba64206ea4c3197.jpg)

##### 3.2.1 配置报销中动作流

配置发起报销动作流，报销流程结束时，发票报销状态变为已报销，操作如下：

1、新建动作流， 添加触发事件为流程触发，选择工作流为上一步骤创建的发票报销工作流，设置触发时机为流程正向归档结束时

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/b4988c6b3ca03b28f2cab5c059b3ddc8.jpg)

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/476d5054e7808625cb6bdf72556dd9d4.jpg)

2、添加执行动作发票报销

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/d60bfd7387422e6a3a873eb7770df742.jpg)

字段配置信息如下：

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/96ec433b588d44f7794f20933d1c3802.jpg)

报销状态： 固定值【已报销】

控制逻辑： 固定值【按全局唯一】

报销单名称 ：动态赋值为上下文流程触发组件的 【流程数据】-【流程标题】

业务对象ID ：动态赋值为上下文流程触发组件的【流程数据】-【流程标识】

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/b5edfd96a610eef9bcc338b0ed75a554.jpg)

操作人 ：动态赋值为上下文流程触发组件的【创建人】-【标识】

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/80518e4b9ebf69cf960b34e25287e13e.jpg)

发票报销数据，点击设置按钮，配置字段信息如下：

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/10d0724a1ff1152a9ed8837eb1517e86.jpg)依据值：动态赋值为流程报销表单名称或者明细表名称

发票：依据值下级电子发票类型控件

发起报销模块：固定值【流程表单报销】

金额：依据值下级金额字段

3、填写动作流名称，保存并启用动作流

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/80022fbb4ab77cacb6ec2969178db321.jpg)

**3.3、发票重复使用设置**

##### 3.3.1 全局唯一

初始的控制逻辑就是全局唯一，现在系统默认还是按照全局唯一控制

这个去重控制逻辑表示：一张发票仅能被使用一次，做一次性报销时请选择该选项。

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/77c749b12cea21755e966c1c5dc9b197.jpg)

##### 3.3.2 按业务ID唯一

这个去重控制逻辑表示：一张发票可以在一个流程中出现多次

应用场景比如：一张餐饮发票，需要按照吃饭时的人头来分摊报销，但发票只能归属一个人，由这个人发起报销，该怎么用这张发票来报销？

那就可以选择按流程唯一，在明细1选择这张发票，对应报销维度，在明细2也选择这张发票，对应其他不同的维度

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/0e3ed031b7715c3c8b6a7532f323745d.jpg)

##### 3.3.3 按发票票面金额进行总额控制

这个去重控制逻辑表示：一张发票可以在一个流程中出现多次

这个去重控制逻辑表示：按照该发票实际被报销的金额进行控制，不允许总报销金额超过所选发票的票面金额，支持一张发票拆分成多次进行报销。

注意：填写的金额大于发票剩余可报销金额时，流程被阻止提交

发票只要存在未核销金额，状态即为未报销状态。

发票金额全部报销完成，才会显示为已报销。

**![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/c9d2c13be3ef4e923c972d9c6a69a54e.jpg)**

**3.4忽略报销金额校验设置**

有些发票的实际报销金额是大于发票票面的总金额的，需要支持报销。启用该设置项时不校验具体报销的金额是否超过发票的价税合计。

