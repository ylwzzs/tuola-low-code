---
aliases: ["1967167212414275410"]
title: 物料入库、出库、调拨更新库存信息
created: 2025-07-15
modified: 2025-07-15
tags: ['ESB中心']
theme: ESB中心
---

# 1.场景说明

当我们进行物料入库、出库、调拨以及库存盘点的时候，因为物料品种以及仓库分布多，所以进行人工调拨十分不便。我们可以利用动作流中的【多次执行】、【条件分支】和【修改表单数据】等执行动作实现物料相关业务的自动化流转，用户只需点击对应按钮，即可一键触发动作流，自动完成物料库存相关业务。

# 2.功能简介：

（1）用户在【物料入库】表单中新建数据时，【物料库存】信息会根据入库的物料进行自动更新，若库存中已有对应物料则在原有的基础上进行增加；若库存中无对应的物料则进行物料库存新增。

![](52875f5757437c181cab2eb6351256e8.jpg)

（2）新增【物料出库】数据时，会对出库物料是否有库存和出库数量是否大于库存数量进行校验，校验通过后【物料库存】信息也会随之更新，并对应减少库存数量；若校验未通过则会提示错误信息并阻止后续动作。

![](5338b67d6a3b6237e220e02074b8886e.jpg)

（3）新增【库存调拨】信息时，会对相关调拨仓库的物料信息进行更新，调拨入库的物料若库存中已有，则直接增加，若没有则进行新增；调拨出库时，则会进行校验，若调拨物料的调出仓库中并没有对应物料则提示错误，并阻止后续操作。最好在挑拨完成后调拨状态变更为调拨完成。

![](120554ffea7197c792036290a3d4a72e.jpg)

（4）用户在【库存盘点】界面新增盘点数据后，勾选需要盘点更新库存的数据点击“更新盘点信息”按钮即可对物料库存数据进行更新。

![](c22295897d95b66b5027c28dbd4d5b5b.jpg)

# 3.操作说明：

（1）【物料入库更新库存】：配置动作流，因“物料入库”设计了流程，所以由【流程触发】。配置对应动作流以及触发时机后，因是对明细表数据进行增加，故使用【内置】--【多次执行】--【LEN\_ARRAY】函数，并增加【修改表单数据】动作，开启【条件不满足时新增】按钮，设置修改条件。

![](106f863eaf5fff0d9394cdfe6e55e624.jpg)

（2）【物料出库校验更新库存】：因【物料出库】也设计了流程所以动作流触发方式为【流程触发】，设置对应的工作流以及触发时机。添加【多次执行】和【表单查询】对数据进行校验，校验物料库存中是否有对应出库的物料，并根据校验结果设计条件分支。

![](d7424253229292b7d79cb65189d42155.jpg)

若有对应的物料则走【条件1】分支

![](7be42412550170252eeb88167968a93c.jpg)

其中条件设置需要注意添加【已执行次数】和对应的查询表单

![](2d6113b2b1bc85de3d1fca571f92dd1e.jpg)

若不满足条件，则走【其他条件】分支，添加【内置】--【输出组件】，并设置状态、提醒内容以及阻止后续操作。

![](de8f0a77c14dd32e75e1fe8e0b747aed.jpg)

在对物料仓库是否有所需出库物料进行校验后，要对【出库数量】以及【库存数量】进行二次校验。若数据满足“出库量小于库存数量”则走【条件1】出口，并修改表单数据，若数据不满足，则走【其他条件】出口提醒，并阻止后续动作。

![](a9c53efc6492f46a60801ef0d88da082.jpg)

（3）【仓库调拨入库已完成】：库存调拨设计了流程，所以动作流触发方式为【流程触发】，配置对应的工作流以及触发时机。添加【多次执行】和【修改表单数据】动作，并开启“条件不满足时插入”按钮，使得在插入的入库数据与库存数据无法对应时进行新增。

![](c630d790f433b0be4c13e133533e82ce.jpg)

在完成调拨库存数据更新后，修改调拨状态为“调拨完成”。

![](389aaf3f0bf9414b6908f870452eaeee.jpg)

（4）【仓库调拨出库已完成】：与上述【仓库调拨入库已完成】动作流触发一致，但需要注意两条动作流的触发时机不能一致（若两条动作流为相同触发时机触发，那么其中一条动作流开启了“条件不满足时插入”，则两条动作流在执行时则都会实现插入动作）。

![](d9c1e3960e5dfe1a367da5658e7b9de4.jpg)

利用【表单查询】进行数据校验，校验库存中是否有对应的出库物料。并根据校验结果设计【条件分支】。

![](6251ca66923b802dd8fdd025e24ca1fa.jpg)

若校验结果为数据可以匹配，则走【条件1】分支修改表单数据；若数据不能匹配，则走【其他条件】分支发出提醒并阻止后续动作。

![](19f47296cd3441e1cbc542b6c1b0e1a0.jpg)

（5）【盘点更新库存数量】：首先要在对应的【库存盘点】表单上新增一个自定义按钮命名为“更新盘点信息”。

![](f7eccec8c3209efc29b700356562d9eb.jpg)

因【库存盘点】未设置对应的流程，所以动作流触发方式为【点击按钮时】触发，并选择“更新盘点信息”按钮作为触发条件。设置【多次执行】和【修改表单数据】动作对数据进行更新。

![](62dfc49c84530d8a4fe7ef9a5aa8dcf9.jpg)

在动作流配置成功后，进入对应表单勾选所需更新的数据点击右上角的“更新盘点信息”按钮即可完成盘点信息更新。

![](7066f712c30e99bae44d99293f206841.jpg)