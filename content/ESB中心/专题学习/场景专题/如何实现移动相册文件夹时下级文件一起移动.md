---
aliases: ["1967593449335670923"]
title: 如何实现移动相册文件夹时下级文件一起移动
created: 2025-07-29
modified: 2025-07-29
tags: ['ESB中心']
theme: ESB中心
---

**1.**场景说明**

在【相册管理】应用中，移动文件夹时其下级文件夹和图片也要移动到目标位置。像这样操作文件夹及其层层下级数据的功能可通过动作流多次执行、条件分支和参数变量实现。

效果如下图所示

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/cfb1e40521e48a4d04437a155a9c88a7.jpg)

**2.**功能简介**

在【相册管理】中，为了将文件夹和照片显示在一个页面，二者的数据存储在同一个表单中，通过开关字段【是否文件夹】进行区分。其中图片可以直接移动，而文件夹移动时除了当前选中的文件夹，其所有下级文件（包括图片和文件夹）也要移动到新的目录或者文件夹下。通过参数变量暂存每一级操作文件的数据，作为查找下一级循环操作对象的线索，每次移动新一级文件后，更新变量值，直到变量值为空，代表没有下级文件需要操作了，文件夹移动完成。

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/7e5d9a7a8f337f92c2943c33f654ac64.jpg)

**3.**操作说明**

1、在文件夹和图片数据行上设计按钮【移动】，点击该按钮打开【选择移动位置】弹窗，用户填写目标目录和文件夹后点击右上角的【确认】触发动作流移动该文件夹及其下级文件夹和图片位置，如下图1所示：

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/5250a689ff87e60fd75275db97873f9c.jpg)

图1 设计存储文件夹和图片数据的表单，实现移动功能的两个按钮

**注意：**为了让动作流识别操作的是哪个文件夹，需要在【选择移动位置】的表单上记录操作的对象及其类型（是否文件夹），这两个记录字段在功能调试完成之后可以隐藏，如图2所示：

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/5b9084f4cb6c949ea07e588383ee9182.jpg)

图2 设计辅助字段存储操作对象及其类型（是否文件夹）

2、新建动作流，当点击【选择移动位置】表单右上角的【确定】按钮时触发，如图3所示：

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/d96c3e21262f4d85c9ac1d0f2096ebdc.jpg)

图3 新建动作流

3、新建**【内置-条件分支】**动作，实现不同类型的移动对象执行不同的操作。当移动对象是文件夹即“是否文件夹等于1“时，需要移动当前文件夹及其循环下级文件（包括文件夹和图片）到选择的目标位置。

**注意：**开关组件的状态值在动作流条件设计器中通过**文本类型的0/1区分**，0代表关闭，1代表开启。

每移动一级文件的位置，我们就要暂存本轮操作文件的ID，作为下一轮操作文件的查找线索，找到新的下级后重复上述动作，直到无法再找到新的下级，过程如图4所示：

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/5d23575c3d37f02ba5837a4601f57478.jpg)

图4 循环移动下级的逻辑图

为实现上述循环移动操作。

先设计一个**文本类型**的参数变量**senior\_folder**用于存储每一级操作对象，并新建**【内置-变量赋值】**动作初始化该变量值为移动对象，如图5所示：

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/85e4d461d7dba70086389eb8907812b3.jpg)

图5 设计参数变量并初始化

直接移动当前选中文件夹到目标位置。新建**【e-builder-修改表单数据】**动作，将该文件夹的所属目录和所属文件夹修改为【选择移动位置】表单填写的选择目录和选择文件夹，如图6所示：

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/6af1af7de25095469172e4e3b5aff5a6.jpg)

图6 修改当前选中文件夹的位置

循环移动当前选中文件夹的下级文件。

新建**【内置-多次执行】**动作，循环方式为“**指定条件**“，循环条件为”senior\_folder不为空“。在循环内新建**【e-builder-修改表单数据】**动作，移动当前文件夹的下一级文件，数据修改类型为”**按条件更新**“，条件为”所属文件夹**属于**senior\_folder“。移动文件之后，通过**【内置-变量赋值】**将本轮移动的文件ID赋值为新的senior\_folder。如图7所示：

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/6c4767e3c9d49b5c35cab120c7f67664.jpg)

图7 移动选中文件夹的循环下级文件

移动效果如图8所示：

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/5a1a38cf9f4f4b1ea9414e12266586a5.jpg)

