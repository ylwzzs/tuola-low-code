---
aliases: ["1969018101002741094"]
title: 产品出库提交时获取最新库存校验
created: 2025-07-15
modified: 2025-07-15
tags: ['ESB中心']
theme: ESB中心
---

#### **一、**场景介绍**

某公司产品出库时需要提交出库表。出库表中关联钻取产品信息表的库存数据，方便同时查看到实时的库存数据。

由于产品库存数量短期内变动较大，因此在数据暂存后再次填写提交时，会出现已经钻取显示出来的库存数据与实际库存数据不一样的情况，会对业务造成影响。

e-Builder表单物品库存表和出库表如下图：

![](f919a65fce9ee51c64b93ab3d344b078.jpg)

##### **二、操作说明**

搭建ESB动作流，添加**e-Builder事件触发**+查询表单组件+分支+输出组件**

**![](eeb8dfc0648b956f2020b3f4d02ad4a4.jpg)**

**其中查询表单组件以库存表数据ID字段等于出库表出库产品（关联eb浏览框）字段为条件；**

**![](b68876c92205fc42621e16397ff34a40.jpg)**

**分支条件设置查询表单组件第1条数据的出库单库存量不等于e-Builder按钮触发组件库存量时执行输出组件-失败；（注意：查询表单组件上下文是数组需要取第一条数据所以数组下标要写固定值0）**

![](6163f4da8be9416a6cba5c5df1b92dfa.jpg)

3、执行效果：

当保存出库单时校验产品联动出的库存数量是否发生改变，若与库存数量不同则阻止保存操作且提示“产品信息有变化，请重新选择关联产品进行更新~”

![](4a9d66651636a934ffbf42f49c1092c7.jpg)