---
aliases: ["1967592195308670914"]
title: 会员收到优惠券后更改会员信息
created: 2025-07-15
modified: 2025-07-15
tags: ['ESB中心']
theme: ESB中心
---

**1. 场景说明：**

如【会员管理】会出现有部分会员当前有优惠券，有部分会员当前无优惠券的情况。若会员无优惠券，那么在收到优惠券后，该会员的优惠券状态会变为是，且明细表对应插入优惠券信息；若该会员本身有优惠券则直接将优惠券信息插入进会员信息。

*展示效果如下图所示：*

![](780dc494a1164b33411e35edc4dca17a.jpg)

**2. 功能简介：**

本场景所使用的动作流是利用【触发事件】--【点击按钮时】触发，添加【执行动作】--【标准应用】--【e-builder】--【表单查询】辅助执行动作，因接收优惠券的人员并非单选，所以添加【执行动作】--【内置】--【多次执行】执行动作，配置LEN\_ARRAY函数。配置后添加【执行动作】--【内置】--【条件分支】进行数据条件筛选，根据当前数据的筛选结果，进入不同的条件分支，执行不同的 【执行动作】--【标准应用】--【e-builder】--【修改表单数据】执行动作。

**3. 操作说明**

（1） 首先选择【触发事件】--【点击按钮时】触发，配置对应应用和表单，选择其触发按钮为新增类型按钮（新建保存、保存并新建、批量新增以及导入），并选择其触发位置为执行后，触发类型为依次触发。

![](7e9f80fb4db4fc55d64dfb6398578a8f.jpg)

（2） 添加【执行动作】--【标准应用】--【e-builder】--【表单查询】执行动作。并配置对应数据源、条件、数据权限、操作人以及查询方式。

![](d7da4cced21ec5bbcd04176f87583002.jpg)

【表单查询】执行动作的意义是为后续的执行动作做铺垫，为条件分支执行动作提供所需表单字段。

其中需要注意，因为同一等级的会员会有多人，所以此处的表单查询需要查询到会员信息表单中的所有数据。若想查询到表单中的所有数据，则要设置其条件为“数据ID不为空”。

（3） 添加【内置】--【多次执行】执行动作。

![](1d21ae45bb0f02d8cfd3c3d20a5379d5.jpg)

因同一等级对应的会员会存在多个，所以这里添加LEN\_ARRAY函数，并将表单中对应字段后的条件设为“全部”，进行多次执行操作配置。

![](0e35a9254d32ae8b12dd9d29bc3a6c15.jpg)

（4） 添加【内置】--【条件分支】执行动作。

![](085ca092387a821cec76c5be2a407204.jpg)

按需配置不同执行条件。

![](2b3a7cfb974f9cd8f84fbc26507151c0.jpg)

条件1：“（是否有优惠券（名称）等于“是”）”

因为上述存在【多次执行】执行动作，所以在配置条件时需要添加“已循环次数”

![](f0b4f73826e717ecb2264a4088aad0d9.jpg)

又因为配置“是否有优惠券”条件需要等于固定值“是”。所以此处选择的表单数据参数为“是否有优惠券（名称）”。

![](66433e4d99b2887094746b3c77dfda80.jpg)

条件2：“（是否有优惠券（名称）等于“否”）”

具体条件配置方式与条件1一致，也需要添加“已循环次数”并选择“是否有优惠券（名称）”等于“否”。

![](8559345954e649eae6a4ccaf99b9c12d.jpg)

（5） 若满足条件1，则触发【执行动作】--【标准应用】--【e-builder】--【修改表单数据】。

其中需要注意，因为上述有配置【多次执行】执行动作，所以【修改表单数据】执行动作的数据ID，需要配置“已循环次数”。

![](47ed2c1f1a35822995abbb2e4a551525.jpg)

对表单数据进行配置，因为要将优惠券信息插入到会员信息表单中。所以此处的优惠券信息选择“追加”的形式进行数据插入。

![](96159f559b6174527e26b6ee07e46984.jpg)

（6） 若满足条件2，也触发【执行动作】--【标准应用】--【e-builder】--【修改表单数据】。

具体配置与条件1一致，这里就不重复赘述。

![](96006f88a37434fda78ed51c6904d8ec.jpg)

其中在表单设置中，需要将“是否有优惠券”字段数据改为固定值“是”，并将优惠券信息进行“追加”操作，将优惠券信息插入到会员信息表单中。

![](b4bc39decf4d9f4310e17daef3f3665a.jpg)