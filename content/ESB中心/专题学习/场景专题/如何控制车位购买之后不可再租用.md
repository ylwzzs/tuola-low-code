---
aliases: ["1967593056689670922"]
title: 如何控制车位购买之后不可再租用
created: 2025-07-29
modified: 2025-07-29
tags: ['ESB中心']
theme: ESB中心
---

**1.** **场景说明**

在许多应用场景中，我们需要根据不同的条件执行不同的动作。例如在物业管理应用中，我们需要对车位进行管理，车位的使用可分为“租用”与“购买”两种方式：业主在“购买”或“租后”后，车位状态也会随之变为“已出售”或“已租用”。与此同时，车位当前所属人、联系方式、到期时间等主表信息会进行更新，并生成该车位最新的一条变更记录明细。

展示效果如下：

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/7acc25483d96083cfc0341cfb9ecd8f5.jpg)

**2.** **功能简介**

上述场景可以通过动作流-【条件分支】功能实现：在动作流的配置中，当用户提交“车位使用”表单的数据后，动作流会利用条件分支判断是“租用”或“购买”，之后根据使用方式的不同执行不同的操作：修改“车位信息”表单中车位状态、当前所属人等主表信息；新增一条车位变更记录明细表信息。

**3.** **操作说明**

1.进行表单搭建：搭建“车位信息”与“车位使用”两张表单，本场景中“车位使用”表单利用eb关联字段“车位编号”实现与“车位信息”表单的关联，并利用数据过滤使选择车位时只能选择状态为“空闲中”的车位。

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/edc1117bb08e9f0e19e580e1ee79e008.jpg)

2.进行动作流配置：

① 设置触发条件：“点击按钮时触发”，选择对应的应用、表单、触发按钮等。之后继续添加动作，选择“条件执行”，条件执行有两种触发方式：按优先级执行（只执行优先级最高的满足条件的分支，其他分支均不执行）；并列执行（所有满足条件的分支同步执行）。

示例：例如有三个条件（条件1、条件2、条件3）：“按优先级执行”就是先执行条件1，条件1不符合执行条件2，再不符合执行条件3，依次执行；“并列执行”就是同时执行条件1、2、3。

两种执行方式各自适用于不同的场景，一般的场景中默认使用“按优先级执行”。

② 设置条件分支，当选择“购买车位时”：首先我们在条件1中进行条件设置，我们的目的是要下拉框字段“购买/租用”等于“购买”时，符合条件。但是在寻找该字段时，我们会发现存在“购买/租用”以及“购买/租用（名称）”两个选择，仔细留意我们会发现，所有的下拉框字段都会存在两个参数：下拉框、下拉框（名称）。在这里需要注意，“购买/租用”代表的是数据ID,无法具体等于某个数值，所以需要选择“购买/租用（名称）”。

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/c683c2c576dfa62f20e6a4b43252f1bc.jpg)

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/de725c2213a615e2b541de7b1820a9a6.jpg)

在该条件下新增动作：修改表单数据，数据ID可动态赋值第一步中提到的eb字段“车位编号”，并进入表单数据设置界面。

主表字段需要修改：由于是购买，车位状态已出售，到期时间为固定值空（即没有到期时间），所属人、联系方式动态赋值购买者信息；

明细表字段需要新增（追加）：依据值依旧选择eb关联字段“车位编号”，购买/租用为固定值购买，其他信息利用动态赋值带入。

配置信息如下：

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/3d944dc86b6700dad9917796f96a2449.jpg)

③ 条件1设置完成后，设置另一条件“租用”：设置方式与条件1相同，表单数据内的内容需要做一下改变，改变的地方已用框线标出，如下图所示：

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/07879a46a4e013630eec1223161bef17.jpg)

④ 小知识点：若一条动作流内的动作太多，为了方便区分辨认，可以为每个动作修改名称

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/0e7d4c0824b2021ed7dcca4abf1b47e4.jpg)

3.动作流设置完成并命名后，整个场景即为配置完成，效果展示：

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/d51a369b58ac77904ea3acf34d148ea2.jpg)

4.知识拓展：在填写车位使用表单时，“购买/租用”选择租用时，会多出一个必填字段“租用到期时间”。该场景运用了表单-【显示属性联动】功能，用户可以查看专题场景[[待下载-未知ID_1967582222992370906|“表单根据数据条件显示不同字段”]]进行学习。效果如下：

