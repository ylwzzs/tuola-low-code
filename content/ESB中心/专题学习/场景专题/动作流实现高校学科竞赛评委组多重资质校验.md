---
aliases: ["1971539167580127616"]
title: 动作流实现高校学科竞赛评委组多重资质校验
created: 2025-07-29
modified: 2025-07-29
tags: ['ESB中心']
theme: ESB中心
---

**1.编写目的**

本期讲解高校学科竞赛的评委组资质校验场景。在高校学科竞赛管理中，有参赛作品库、专家库、参赛组、和评委组这几个表单，组委会调整参赛组的专家评委名单，提交保存时需要对组内专家进行如下3种规则校验：

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/4e169dc8adfc8e116545b1c85b8cbe3f.jpg)

校验失败时阻止编辑保存并提示失败原因，以确保组内专家评委全部具备所在参赛组的评审资格，维护学科竞赛的公平性。

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/5eb4beb9ef80ef4be5c0627113885f52.jpg)

本场景中利用动作流实现对表单明细数据的多重校验，并且在设计动作流时将3种独立校验逻辑封装成3个自定义触发动作流单独维护，在主校验动作流中对其进行引用嵌套，实现对复杂动作流的高效管理。

## **2.思路分析**

2.1针对专家评委的每条明细数据都要进行3种不同规则的数据校验，需要对明细表进行数据遍历，一旦有一条明细不满足规则，则代表检验失败，跳出循环，提示校验结果，阻止数据保存（循环组件）；

2.2三重校验思路分析：

（1）**组内专家不**能重复：**对组内专家姓名进行分组汇总（数据汇总组件），如果分组数量小于原始姓名数量，则代表存在重名发生了数据合并，存在组内专家重复，校验失败（条件分支组件）

（2）**专家任职院校不能是组内参赛作品的所属院校：**先从专家库查询专家任职院校（数据源查询组件），再查询参赛作品库中所属院校等于专家任职院校且参赛组别等于评委组参赛组别的作品数量（数据查询组件），若查询结果数量大于0则代表专家院校和组内参赛作品所属院校相同，校验失败（条件分支组件）

（3）**专家不能是组内参赛作品的提交人、指导老师或者团队成员：**查询专家所属参赛组别的作品库中，专家姓名出现在提交人、指导老师或者团队成员姓名这几个字段的数据条数（数据源查询组件），若查询结果大于0，校验失败（条件分支组件）

2.3从上述分析来看，要想实现遍历明细表对每条数据进行3重规则校验，需要在循环内部添加多个执行组件，最终的动作流纵向长度会很长，不利于后期的维护管理。

我们可以将三重规则校验设计成三个自定义触发动作流，输入每次校验的专家及其所属参赛组别信息，输出校验结果，主校验动作流的内部仅需要引用这三个自定义触发动作流即可。

## 3.操作说明

**3.1**维护表单信息：**参赛作品库、专家库、参赛组、和评委组

参赛组别表单：

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/8f572d510444268ea0123289ad346eca.jpg)

参赛作品库表单：

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/3e87c970a37dffdd70b0feaef5bb1704.jpg)

专家库表单：

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/9388482529825538937d3ca23b3abf1a.jpg)

评委组表单：

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/e4c4ea5568302605dd1dfb183268abde.jpg)

**3.2**搭建【组内专家不能重复】校验动作**

新建自定义触发动作流，接收组内专家明细作为校验对象，输入参数需要设置为明细表

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/274093658d6c2d6d598d807a294db48a.jpg)

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/7a699e7d203e37d0ddd3760245d1559b.jpg)

添加数据汇总组件，对组内专家按照姓名进行分组汇总

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/168f63ef6328994a489b57fe491ed7b8.jpg)

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/1ae87b7c39aaa0979e95fb4ab45444af.jpg)

用LEN\_ARRAY()函数分别就算分组合并后专家数量和原始明细的专家数量，若前者小于后者，则说明存在相同专家被分组合并了，不满足校验条件，输出参数【校验结果】等于0，否则代表校验成功，输出参数【校验结果】等于1

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/88a30858d60bad796e13111c7e36bab4.jpg)

**3.3**搭建【专家任职院校不能是组内参赛作品的所属院校】校验动作**

新建自定义触发动作流，输入参数为专家名称、参赛组别

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/c659baa23da861d13e100bb7f6c77046.jpg)

添加数据源查询组件，查询专家任职院校

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/5803c9692658f94fe92ed690728476eb.jpg)

添加数据源查询组件，查询当前参赛组中是否存在所属院校和专家任职院校相同的作品

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/f770d2ab98d07c2ea796341b5b2d684a.jpg)

若第二个数据查询组件查询结果数量大于0，代表作品库中存在参赛作品和专家属于同一院校，输出参数【校验结果】等于0，否则代表校验成功，输出参数【校验结果】等于1

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/3416c8a9efbe953b920e0bdde770d65e.jpg)

**![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/b2654ff56e78432f5f45b804ad437a59.jpg)**

**3.4**搭建【专家不能是组内参赛作品的提交人、指导老师或者团队成员】校验动作**

新建自定义触发动作流，输入参数为专家姓名、参赛组别

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/937a377e1fd4bf18b40905d2def19a53.jpg)

新建数据源查询组件，查询是否专家姓名是否出现在所在参赛组别的作品库相关字段中。其中数据源必须选择业务模块-ebuilder表单，可直接选择参赛作品库的【团队成员】明细表，同时获取明细字段和主表字段进行数据校验。（只有物理表支持明细表查询，共享表不支持）

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/60980467c1001060d3307dfc87e25d93.jpg)

若查询结果数量大于0，代表专家是所在参赛组作品的提交人、指导老师或者团队成员，校验失败，输出参数【校验结果】等于0，否则校验成功。输出参数【校验结果】等于1

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/c599374b0a5e0141684b66417fa0f8dc.jpg)

**3.5**搭建主校验动作流，嵌套引用上述校验动作**

新建触发动作，点击评委组表单的编辑保存按钮**执行前**触发

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/608311f0d032d9d46dcdf03b76de4837.jpg)

先引用自定义触发组件对规则【组内专家不能重复】进行校验

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/8a1cffbb5f77edf45fb80e27c85c0975.jpg)

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/b5a9d5f9f04393b7a8ec4cd14c966566.jpg)

根据【组内专家不能重复】组件的输出参数进行条件判断，若校验结果等于0代表校验失败，提示失败原因并阻止编辑保存

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/0dd540941b71fbb7ab46377ef6ce6184.jpg)

若校验成功，则需要进行另外两个规则校验，在其他条件下添加循环组件，遍历调整后的专家评委明细表

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/55d7c08128de1374e22da0866b63f0f3.jpg)

循环内引用自定义触发动作流【专家任职院校不能是组内参赛作品的所属院校】和【专家不能是组内参赛作品的提交人、指导老师或者团队成员】，并映射输入参数

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/01c1957003e184fd8c3c848ec806af8d.jpg)

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/cd7b15b76abe4b4f52a094e8f91d02ba.jpg)

说明下为什么【专家不能是组内参赛作品的提交人、指导老师或者团队成员】这个动作输入参数时专家名称选择姓名（名称）这个参数，而其余两个动作中都选择不带（名称）的参数。在评委组中，姓名字段是专家库的关联ebuilder字段，标题栏是专家姓名，在参赛作品库中，提交人、指导老师和团队成员姓名这几个字段都是单行文本直接填写人员姓名，关联字段不带（名称）的参数返回的是数据ID，数据ID和人员姓名肯定不能对应，因此必须选择姓名（名称）获取标题栏字段内容，与指导老师等字段进行比较。

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/01edca308b418e3ad40a9ca629bd3c34.jpg)

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/543d3d99de8af97690f93731f4e11490.jpg)

为提高动作流的执行效率，避免超时异常，只要有一个专家不满足评审资质，就终止循环校验，报错提示。添加一个布尔型应用变量【校验结果】，默认值为true

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/8eaf7d557b6a03aafc1ba1f06e357239.jpg)

如果两个校验动作存在输出校验结果等于0，代表校验失败，更新应用变量值为false，跳出循环；若当前遍历校验的专家通过资质校验，则继续循环校验下一个专家，直到循环结束

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/a6804aa848d0b794110c6c8e6422e19d.jpg)

循环结束后根据应用变量【校验结果】的最终值判断循环属于校验失败跳出终止还是校验成功正常终止，若校验结果等于否（即false），说明校验失败，添加页面交互组件提示失败原因并阻止编辑保存；反之代表专家全部校验通过，编辑保存正常执行。

