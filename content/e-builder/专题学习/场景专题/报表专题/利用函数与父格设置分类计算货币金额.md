---
aliases: ["1967592620639070918"]
title: 利用函数与父格设置分类计算货币金额
created: 2025-07-15
modified: 2025-07-15
tags: ['e-builder']
theme: e-builder
---

**1.** **场景说明**

利用sum函数与单元格父格设置，可以实现分类计算货币金额。例如在进销存管理应用中，需要对各部门进货商品价格进行小计，并对所有商品价格进行总计，则可以利用该功能实现。

展示效果如下：

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/2df3794da86e0866f22c3dfe53c736e8.jpg)

**2.** **功能简介**

上述场景可以通过sum函数与父格设置搭配实现：sum函数指的是返回某一单元格区域中数字、逻辑值及数字的文本表达式之和；父格设置可以实现报表解析的时候以特定的单元格为基准进行数据横向或者纵向扩展。两者搭配使用，即可实现各部门金额独立计算（金额小计），并计算所有金额之和（金额总计）。

**3.** **操作说明**

1.基础设置：在报表设计器中，设置报表的显示字段以及文本标题。为了便于直观展示各部门进货金额，可以将部门放在第一列，并设置显示方式为分组显示，由于该报表为普通列表式，其他表单字段父格、显示方式等均为默认值，无需变动。

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/4a1be6994a35855d952e2fa0b0603da2.jpg)

2.进行sum函数配置：sum()统计各部门”商品总价”，由于此时统计的是各部门商品总价，该单元格随着部门字段的分组分别展示，所以将该单元格的左父格自定义设置为单元格C4（即部门字段）。同理，可用函数统计各部门进货商品”含税总价”，单元格左父格同样为C4。

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/d5d970c14e430647f037f76438218b70.jpg)

3. sum函数统计所有部门商品总价与含税总价：统计所有总价时，由于总价不会伴随某一字段而变化，所以该函数单元格的左父格与上父格都设置为“无”。

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/3521d9d77c8dd984eeccd1b733995ced.jpg)

4.效果预览：此时可以看出sum函数已生效，但是报表比较简陋，需要进行优化，例如设置单元格列宽与行高、设置金额字段、调整字体大小与填充效果、sum函数前加上文本说明等。

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/b148cd303ef728b4a0b6057ac8333810.jpg)

5.效果展示：可以看到函数字段分别小计每个部门的金额情况，并总计所有部门的金额情况，注意：sum函数前的文本说明，其单元格的左父格与上父格设置要与函数本身相同。（报表外观样式因人而异，用户可根据自己的喜好进行报表样式的设计）。

