---
aliases: ["1971375426109626744"]
title: 利用表单函数实现汇总活动报名人员明细
created: 2025-07-15
modified: 2025-07-15
tags: ['e-builder']
theme: e-builder
---

**1.** **编写目的**

本期主要讲解活动管理中汇总明细表报名人员的场景。用户在明细表中填写各部门活动报名人员，此时管理者想要直观的看到所有的报名人员，就需要将多行明细中的人员全部汇总到主表的一个人员多选字段上，实现明细表多条人员信息的汇总

本场景中利用表单函数公式，将明细表字段的值汇总到主表字段中，明细表新增或修改信息时，主表会汇总最新的信息，从而实现明细表与主表的实时联动。

**2.**思路分析**

为了实现上述场景，我们需要在主表与明细表中分别额外放入一个单行文本字段，用于承载人员id。首先将明细表每条数据的人员id放到明细表的文本字段中（公式1），之后将这些明细表的人员id汇总到主表的单行文本中（公式2），最后再赋值到主表的人员多选字段上（公式3）。展示效果如下：

![](a1ac47d441c53d628d08156ae01b17f3.jpg)

**3.** **操作说明**

**1.**新建活动报名申请表**

如下图所示， 新建活动报名申请表，表中包含活动名称、活动日期、参与人员汇总（主表人员多选字段）、部门（明细表部门单选）、参与人员（明细表人员多选字段）等，目的就是将明细表多行的参与人员汇总到主表当中。

![](f5129d39c903d3f40b87d89d4fa4dbf4.jpg)

在该场景中，我们需要在主表和明细表中各放入一个单行文本字段，用来承载人员id（因为人员选择字段的主键其实是人员的id，名称只是显示），放入字段后，设置隐藏：

![](812b9e7b852ab2e95908080d520d0a6e.jpg)

**2.**函数公式实现明细表人员汇总**

公式1：明细表人员id赋值到明细表文本中

该公式比较简单，直接利用左上角的函数公式，设置明细表“参与人员”字段值改变时，设置等式即可，如下图所示：

![](89f0f7fe2afdc635a87b5ec684fb54df.jpg)

公式2：主表文本汇总明细表文本

设置“明细表文本”值改变时，利用CALDTROW函数逐行获取明细表单行文本上的人员id字符串，并设置逗号隔开：

![](7e5657806cafad3e5154de8f674b6de9.jpg)

公式3：主表文本汇总的人员id，赋值到主表人员选择字段

与公式1类似，直接设置“主表文本”值改变时，两个字段相等即可：

![](def708365a326d8e12365d1a2660804a.jpg)

将隐藏的字段显示出来，展示一下效果：

![](9ab8b2a9718303a2a643ef4efd7142ca.jpg)