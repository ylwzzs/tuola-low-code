---
aliases: ["1964258550582814168"]
title: 飞书集成
created: 2025-07-15
modified: 2025-07-15
tags: ['云桥']
theme: 云桥
---

**一、概述**

支持与飞书系统集成，包括“通讯录同步”“应用集成到飞书"”消息互通“，即实现在飞书上使用我们的应用，包括推送消息。

二**、操作说明**

- [[#企业集成|企业集成]]
- [[#应用集成|应用集成]]
- [[#消息推送|消息推送]]
- [[#通讯录同步|通讯录同步]]
- [[#扫码登录|扫码登录]]

  [[#消息推送]]

  [[#消息推送]]

# **【云桥对外域名】配置**

集成飞书需要配置外网域名地址，在【云桥】-【基础参数设置】配置当前系统的外网域名地址，配置好之后点击保存，位置如下图所示：

![](2a82de496db4f4b2917bdfc9dca0ad72.jpg)

**【开通服务器网络权限的说明】**

1.如果使用本系统进行钉钉集成功能，则需要调用钉钉接口，并且最终用户是通过钉钉来使用集成的功能，所以本系统部署的云桥服务器必须要求，能够访问外网：即开通这台服务器的上网权限，让云桥服务器能够访问互联网，如果贵公司对网络安全要求较高，至少需要让这个服务器能够访问以下地址：  
飞书API：https://open.feishu.cn  

2.同时请网络管理员将本系统的访问地址映射到外网。  

3.可以用如下方式验证网络是否通畅：  
在云桥服务器上按如下方式检查网络：  
ping open.feishu.cn 查看是否能ping通  
Window:  
浏览器访问 https://open.feishu.cn/open-apis/contact/v3/users 查看是否有返回结果  
Linux:  
执行命令 curl https://open.feishu.cn/open-apis/authen/v1/access\_token 查看是否有返回结果

**1. 企业集成**

飞书接入功能主要是在云桥中建立飞书接入信息，将基本的企业CorpID等写入云桥中；

（1）点击后台管理中心，在所有服务中选择云桥或者平台引擎里点击云桥，即可进入云桥页面，如下图所示：

![](18b217a68460f9d628766d0e66806996.jpg)

（2）访问【飞书集成】菜单，点击右上角【新建飞书】，如下图所示：

![](d9f1ee4dcf928af58f0e3a4b21f08374.jpg)

（3） 输入企业名称，API服务地址默认带出，如下图所示：

![](7c3ab3ae50e19cd7cae46d0f5abb89b1.jpg)

# **二、应用集成**

### **2.1飞书开放后台创建应用**

（1）请登录飞书开放后台<https://open.feishu.cn/app>，进入【企业自建应用】，点击【创建企业自建应用】，如下图所示：

![](69a2f5e414d01bb74afd8afc18a0734f.jpg)

（2）创建应用后，即可获取到AgentID、Secret，如下图所示：

![](fa725e84bdedce39f3dda6e35c71458c.jpg)

### **2.2云桥集成应用**

（1） 访问云桥【飞书集成】，在当前集成的飞书页面，点击【添加应用】，如下图所示：

![](10f9567d43b78bc36d682f0ee8948e8c.jpg)

（2） 进入应用详情页面，填写飞书应用的应用名称、AgentID、Secret【步骤2.1中获取到的应用信息】，如下图所示：

![](14d772e4c4bb3a08f14ef1774a4b5592.jpg)

（3） 应用主页 是设置飞书应用的主页功能，调用模块默认为打开应用，选择应用中心已经存在的主页型应用，如下图所示：

![](d3d32fc86b03573574d7fd311b825787.jpg)

![](9f9e2884fd7ad0134dd4b068bda5b297.jpg)

也支持自定义链接地址，如下图所示：

![](10ff4199abe211a699db034f37b9568e.jpg)

### **2.3云桥应用和飞书应用匹配**

(1) 打开飞书后台应用的【应用能力 】，选择【网页应用 】后进行配置，将上一步在云桥获取的应用主页地址，配置到【桌面端主页 】和【移动端主页 】，如下图所示：

![](6e9e0ab6e770f88f1f8c450d2fde8324.jpg)

(2) 点击飞书应用【开发配置 】，选择【重定向 URL 】，点击【添加】按钮，将上一步在云桥获取的重定向URL地址，配置到【重定向 URL 】，如下图所示：

![](70b95ce4ee74bc29f9e263c3d2163681.jpg)

当使用oa系统部分功能需要调用jsapi等功能时，需要校验可信域名。将配置的云桥对外域名添加到飞书安全设置H5可信域名中即可，如下图所示：

![](461bc1c77f154634c79c59f38168ef88.jpg)

(3) 可以在飞书【成员管理】里，维护可以管理飞书此应用的成员，如下图所示：

![](3ef1c91d36b1afeaf4ddce7de740fb78.jpg)

(4) 在飞书【应用能力】中，添加【网页应用】和【机器人】能力，网页应用在点击应用时会使用到，机器人在接收消息时会使用到，如下图所示：

![](793e85b813ccd60e8e15a0da016136d2.jpg)

(5) 飞书应用【权限管理】

【通讯录权限范围 】建议设置的范围与应用的可用范围一致，如下图所示：

![](eb81165156ec324ebbd51eb920f51b97.jpg)

(6) （重要）【应用权限配置】将其中的【通讯录】、【消息与群组】、【考勤打卡】、【审批】、【应用信息】、【企业信息】相关的权限全部开启，如下图所示：

![](16a8db1050fdc8712f8d4a221677690c.jpg)

(7) 飞书应用发布，点击版本管理与发布的【创建版本】按钮，将信息填写完整后，点击保存，如下图所示：

![](f04fe72c27c5067b29b844cce0ccd77c.jpg)

保存后，点击【申请线上发布】即可，如下图所示：

![](d1065131b5526a5e5e80e2745f4f1525.jpg)

(8) 应用发布后，需要管理员登录飞书管理后台https://www.feishu.cn/admin，审核该应用，点击通过后，该应用就正式配置完成，如下图所示：

![](0f73766215318a452e9bab2fe5dbda64.jpg)

![](b0e8d82d5ec749fd4d5fdaca3c50eab6.jpg)

# 三、**消息推送**

### **3.1 消息规则配置**

消息管理功能主要是将OA应用消息推送到飞书中，即实现在飞书中接收并处理业务系统的消息。消息正常推送的前提是，飞书用户要关联OA系统用户账号。

(1) 在【云桥】-【消息推送设置】-【消息推送规则】 页面，点击新建，如下图所示：

![](ae32924bad80a4ad9357ce6d14bcf8c9.jpg)

(2) 例如将 日报 的消息推送到飞书：填写好规则名称，消息来源选择日报，如下图所示：

![](8c2387bb9980c34d795cb5efd58323f5.jpg)

在规则详情页面，点击【新建】，设置推送目标，第三方企业类型选择【飞书】，企业和应用根据实际需要，选择对应的企业团队和应用，如下图所示：

![](8e64830fb10d9ce696b0d2a2a974b6a4.jpg)

消息类型有：文字、图文、待办、卡片消息，可以根据需求选择相应的消息类型，效果见3.2消息类型示例；

![](e216a96b0e7180e3a19feef14493b77c.jpg)

注意：推送目标新建之后，要点击【保存】，如下图所示：

![](7f4e43a3780677a3661ce43bbc245c38.jpg)

消息推送规则新建之后，可以点击【编辑】按钮，对规则详情进行编辑，如下图所示：

![](d78cc34d4b38f3a075f1a71f7af7ecc2.jpg)

(3) 将 日报 的消息推送到飞书：除了第二点中所述将消息来源选择日报之外，还可以将消息来源选择为全部，如下图所示：

![](0ba76d3a08c8dd1b3e3367475f4d5e88.jpg)

注意：若消息来源选择全部，OA其他应用的消息（例如审批，出勤等）也会通过这条消息推送规则推送到飞书。

### **3.2消息类型示例**

(1) 文字

![](ceb4a3e096ebfa15ca97e5a32ca8f1bb.jpg)

(2) 图文

![](26782fa62d522ef85f71baa33fb36d59.jpg)

(3) 待办【未开启快捷审批待办】待办到达样式

![](247ad3efebc78a9bde3bb88ad751439c.jpg)

待办【未开启快捷审批待办】待办转已办样式

![](2325e961d7bbcff7a007fe83f6b7d4a4.jpg)

待办【开启快捷审批待办】pc端所有样式

![](13eb2a5e85003f138192909a2abbe69e.jpg)

待办【开启快捷审批待办】手机端所有样式

![](236500e9b6206e0fbb2cdc38d621c965.jpg)

(3) 卡片消息

PC端效果：

![](39dc159c05662ca548a9f2bcc949822f.jpg)

手机端效果：

![](f8516c8d93a9b6750efeec98fa3930ba.jpg)

# 四、**通讯录同步**

### **4.1前提**

云桥组织架构同步分三种：

(1) 将 飞书 的组织架构同步到 云桥（不修改OA的组织架构）

![](2f212121ec3f104a5193a895668817cf.jpg)

(2) 将 飞书 的组织结构同步到 云桥 同时同步到OA（修改OA的组织架构）

![](ccc3a8c1c8a7345ae980e9e1b89b039d.jpg)

(3) 将OA 的组织架构同步到 云桥，同时同步到 飞书（默认在同步前会先执行“从飞书同步组织用户绑定关系”，以保证从OA同步的时候正确比对用户和部门信息）

![](2c56c2e8974d30b72de17e0b70466da2.jpg)

### **4.2同步功能相关配置**

(1) 执行同步前，需要已经集成过对应应用；

![](dc89b0b593d75fa85be4a7f8ed6f7574.jpg)

(2) 进入【通讯录管理】，未进行过配置，在执行【从飞书同步组织用户绑定关系】时，首先会提示配置【接口参数设置】，切换到【接口参数设置】页面，选择集成的应用，点击保存；

![](ba3f95deb9c003168ccced88a1f9f4aa.jpg)

l接口权限-只读：只能执行【从飞书同步组织用户绑定关系】同步到云桥，不能在云桥通讯录调整数据，一切以企业号的组织架构为准；

l接口权限-读写：可以执行【从飞书同步组织用户绑定关系】同步到云桥，也可以执行【同步通讯录到飞书】；

l选择应用：选择同步依赖的应用；

**4.2.1 从飞书同步组织用户绑定关系**

![](a3646e2a4d995ca66992383e763d3e53.jpg)

l新用户关联系统：设置本次同步过来的新成员（即云桥中不存在关联关系成员）是否要自动建立与OA组织架构中用户的关联关系。具体使用见4.3.1章节

l是否定时同步：定时任务，开启可执行定时从飞书同步组织架构。

**4.2.2是否同步到OA**

**![](05f979d6d14289d7cd70ae306bb808d2.jpg)**

是否同步到OA：总开关，决定是否将云桥本地的数据同步到E10组织架构，默认关闭。

具体可参考：[[#/main/cs/app/86421e44bf26440ca951b35c3ad1fa4c_baseTable?fileid=29176962&tosharerinfo=56634&tosharetype=person&_key=ttd9i8|从云桥同步到E10]]

#### **4.2.3 同步通讯录到飞书**

(1 ) 基本设置

![](0b3bf54c44e58a41b24d9465cc3e92e9.jpg)

l顶级部门：执行【同步通讯录到飞书】，会将选择的部门以及用户，挂载到选择的顶级部门下面；

l新用户是否添加到飞书：设置从OA同步过来的新成员是否要调用飞书接口自动创建到飞书通讯录中；

l用户所在部门是否包含兼职部门：默认只同步用户的主部门，开启后，同步范围中包含用户的兼职部门，则会同步到飞书；

l离职用户处理方式：禁用表示ecology中的离职用户将在飞书中被设置为禁用状态，即此用户将禁止使用飞书但通讯录中还可以查询到此用户并会占有飞书后台的用户数量；删除表示离职用户将从飞书中删除，通讯录中不再有此用户，不占用飞书后台的用户数，需要注意删除后此用户在飞书中此企业下的消息记录即飞书自身业务功能的数据也将被删除，即删除后重新添加此用户将是一条新的成员数据，历史数据都将消失，为了避免误操作，建议此处选择禁用模式；

l禁用用户几天后删除 ：默认不填即不删除；如果配置为0天，则表示不删除；如果配置为7，则表示用户被禁用之后7天后删除；只支持正整数天后删除；可以在用户详情卡片中查看具体禁用时间；

l禁用成员是否移动到统一部门：如果离职成员处理方式选择的是禁用，且开启了此配置，离职成员将被禁用并移动到部门名称是“已禁用用户”的部门下（默认部门名称是“已禁用用户”，用户可以根据需要自定义部门的名称）；

l用户绑定：将OA用户和飞书用户关联。详情见 【4.2.4 用户绑定/解绑】

l用户字段对应关系：该配置可以将成员在EC系统的里个人信息，同步到成员在飞书里的个人信息里；

(2) 范围设置

系统默认会将系统中的所有部门及用户数据同步到飞书的通讯录中，同步范围不需要做任何设置；

如果有特殊的需要只将一部分部门及用户同步到飞书的通讯录中，则可以设置需要同步的部门及用户范围（也可以部门和用户分开设置）；

不在此范围内的并且已经与系统建立关联关系的部门或用户将会被从飞书中删除，并且删除操作不可逆转，所以请谨慎选择范围。

![](255cd334ff1e905da2f0c1e3c5390147.jpg)

l分部/部门范围：不选择特定分部/部门，默认为全部

l用户范围（包含）：在此范围内的用户将被添加或者更新到飞书

l用户范围（排除）：在此范围内的用户不会被添加到飞书，如果用户已关联了飞书用户，同步后将被删除。谨慎选择

注：部门和用户可以分开设置；

用户范围（排除）的优先级高于 用户范围（包含）；

(3)安全设置和定时设置

![](937de24a27320e9d5efe1fbe485e4954.jpg)

l用户减少数量阈值：本次同步的OA用户数量和上一次相比，减少的数量超过x，将停止同步OA用户信息，x可以自己设置；

l定时设置：设置是否开启定时自动执行同步通讯录到飞书的操作。

#### **4.2.4 用户绑定/解绑**

将OA用户和飞书用户绑定的方式有多种：

(1) 手动绑定（需要配置应用）

用户完成应用集成之后，可以直接访问飞书应用，然后输入正确的oa系统账号密码后，对应集成的飞书集成-通讯录管理中会记录用户的飞书账号信息以及绑定oa账号关系。

![](b5841538a277f0bea9f1432644a6b0f0.jpg)

(2) 自动绑定设置

有两个设置的地方：一个地方配置之后，另外一处也会开启自动同步；修改任意一处，也会变更另外一处的设置。

l从飞书同步组织用户绑定关系-->新用户关联系统账号（使用见4.3.1）

l同步通讯录到飞书-->用户绑定（使用见4.3.2）

注意：若任意一处开启了关联设置，此时用户访问应用，也可通过关联设置自动关联；

![](78dd5994a67c77ee170ab84f873b41bf.jpg)

![](d37db30cd7a0e6adbc66b3efced02d23.jpg)

(3) 关联导入

![](aaccaa081a39f0b470e3d801812d89cc.jpg)

将已经同步到云桥本地的数据导出，并且将需要绑定的OA用户的对应字段写入到文档关联字段那一列，上传文档，点击导入按钮，即可将关联关系写入。

例如：飞书用户B要绑定OA用户的B1，选择的关联字段是【手机号】，在导出的B这一栏的关联字段中，填写B1的手机号，保存后将文件再导入，并且关联字段选择【手机号】，然后点击导入按钮即可。

![](322e3bb44eecc811e7b81718cc959e6f.jpg)

![](77ea968f403d4a56253a3b050773a868.jpg)

![](79c71a4625c00dbc579481b51a0f390d.jpg)

![](62eef6fd5adcbbdc08dba2b3492ed357.jpg)

(4) 用户卡片绑定/解绑

![](54c17d02fd7e7ac9ffc818756de8fe7a.jpg)

![](353f29a230597ad4a28e6963bd4658e1.jpg)

(5) 批量解绑

解除云桥本地所有用户和OA用户的关联关系；

![](ec97cf280d31cc93237fe24b9ccd68f9.jpg)

### **4.3同步功能使用说明**

云桥主要是将飞书和OA的组织架构关联起来，所以同步前需要确认组织架构以飞书端为准，还是以OA端为准！

#### **4.3.1 以飞书组织架构为准**

首先执行【从飞书同步组织用户绑定关系】，然后把用户在飞书中的身份和在OA系统中的身份关联上，使用如下任何一种方式：

方法一：手动关联（见4.2.4）。

方法二：在 从飞书同步时进行自动关联：需要在【从飞书同步组织用户绑定关系】时，开启【新用户关联系统账号】，配置关联字段之后，进行同步。

例如：用户在 飞书的身份 和OA身份 使用 飞书手机号 匹配 OA手机号 进行关联。

![](be8b3fee76b2426526c5ed33d8a10f3c.jpg)

后续可以在 【从飞书同步组织用户绑定关系】时，开启定时同步，每隔一段时间将飞书的组织架构的变动更新到云桥。

![](e66c206db2caddfbd7ce31e0b6d00fea.jpg)

如果不希望在OA修改组织架构或者在云桥菜单中修改后影响到飞书的组织架构，可以开启通讯录的只读模式：只允许飞书的修改同步到云桥本地。

![](b2894a94bb5ec1505f91c01d6bc5d266.jpg)

是否同步到OA可以参考章节4.2.2；

#### **4.3.2 以OA组织架构为准**

分为两种情况：

##### **4.3.2.1 飞书没有组织架构**

（默认已经执行过从飞书同步组织用户绑定关系）

① 无需进行用户账号绑定。

② 执行【同步通讯录到飞书】，执行完成后，云桥会把OA的用户创建到飞书，并且自动把用户在飞书中的身份和在OA系统中的身份关联上。在创建飞书用户时，飞书用户的账号使用的是OA用户如下配置字段的值：

![](111bdde6289141544a1fb5667ca18de0.jpg)

##### **4.3.2.2 飞书有组织架构**

（默认已经执行过从飞书同步组织用户绑定关系）

(1) 设置飞书历史用户（即飞书已存在的用户）账号绑定，选择如下任意一种方式进行关联：

方法一：手动关联（见4.2.4）

方法二：自动关联，在第二步执行同步的时候配置用户匹配字段。

![](4c49d76299b3d3b2338bdc00270e251d.jpg)

注：如果自动绑定无法满足将飞书用户和OA用户关联，可以在从OA同步前先使用手动绑定关联这些用户。

(2) 设置顶级部门

是否设置顶级部门决定了同步后的组织架构；

部门关联的逻辑是：层级相同且部门名称相同，在执行同步的时候，会自动关联，否则，在云桥和飞书新建部门。关联上的部门前面会有一个黑色实心原点，代表已关联；

举例说明：分为两种情况，没有设置顶级部门和设置了顶级部门；

l没有设置顶级部门，默认同步OA整体组织架构

![](64179187b29303b92dadd98357d6cd36.jpg)

如下图所示，根据层级和名称首先进行顶级部门匹配，则OA顶级部门【演示部门】去匹配云桥顶级部门【演示部门】，可以匹配。一级部门能够匹配上的只有【部门A】，则其他没有匹配上的部门，会在云桥和飞书新建。

![](9ddfd95753d5037a12a863f3001f5026.jpg)

同步后效果（可以先同步模拟同步查看效果）：橙色为匹配，蓝色为新增；

![](6fe9d80cb24044b9eb71144bc7c55b3e.jpg)

注：如果顶级部门的名称不相同，例如【Re部门】和【演示部门】名称不同，则顶级部门无法匹配，同步立刻中止。

![](08f4f0c63035d4b4dbc42033ae0390c7.jpg)

报错提示如下：

![](59496e1aaa564f22316ce8d76392319e.jpg)

l设置了顶级部门，默认同步OA整体组织架构。

选定【其他部门】为此次同步的顶级部门：

![](a7f4c021cbf114e073ce7d32a11a5f6b.jpg)

如图所示，组织架构层级对应如下：

![](93d83480e9591d4af679088f64facf6f.jpg)

执行同步，会将OA【Re部门】及其下级部门，同步到云桥【其他部门】下，作为顶级部门。

根据部门匹配的原则，OA一级部门【Re部门】和顶级部门下的一级部门没有名称相同的，直接新建。

同步效果如图：

![](b2c4dc58929c20d4aa2473560fea1849.jpg)

# 五、**扫码登录**

**此功能在企业集成--业务集成，此功能主要实现通过飞书自带的扫一扫功能扫描OA**

**系统首页的二维码进行登录OA系统，具体位置如下图：**

![](ec5e7dd66f620bf0d65915dc2851f37f.jpg)

如果在未集成企业和应用的情况下，直接点击后面的【设置】按钮，会提示“请先添加飞书”，故配置扫码登录功能前，请先集成企业和应用，参考手册第一、二点。

点击扫码登录功能后面的【设置】按钮，进入配置页面，先点击开启按钮，再选择集成的应用后保存，如下图所示：

![](c46dc74abe669cdca51fd48d1cf58e8f.jpg)

打开OA系统登录首页，扫码入口在右上角，如下图所示：

![](aa5416b24aacbc31502c88acfe66d850.jpg)

使用手机端飞书自带的扫一扫功能，扫OA系统登录首页二维码，如下图所示：

![](3bb4c1b86e2867a500e95f79bf0f4bfe.jpg)

扫完之后，需要选择租户（也就是团队名称）及集成的企业名称，如下图所示：

![](80658d99698b36084123ba3d11921714.jpg)

选择完企业之后，如果人员在集成企业的通讯录里无关联关系且未开启自动关联（如下图1），则会出现此界面（如下图2）：

![](cec04cbb73ac0e985247af61ca57c344.jpg)

![](30f30d42956425479eea94afc6a53f06.jpg)

需要人员建立了关联关系后才可正常登录oa系统，具体建立关联的操作方法可参考4.2.4的①手动绑定②自动绑定设置（开启了关联设置，此时用户访问应用，也可通过关联设置自动关联）④用户卡片绑定；扫码选择完企业后，若建立了关联关系，就能正常登录oa系统页面，效果如下图所示：

![](f94641b7b4eb917b9b191787be6b7c3c.jpg)