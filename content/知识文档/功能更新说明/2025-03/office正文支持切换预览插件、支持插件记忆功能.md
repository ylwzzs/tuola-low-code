---
aliases: ["1974825331308897656"]
title: office正文支持切换预览插件、支持插件记忆功能
created: 2025-07-14
modified: 2025-07-14
tags: ['基础模块']
theme: 知识文档
---

## **需求背景**

1. 客户对正文和附件的定义区分很明确，但是由于没有购买在线编辑插件，所有office文件都只能放在附件，没有办法放到正文

2. office正文的查看不支持切换预览插件

3. 系统不支持记录用户上一次使用的预览插件，每次都要手动进行切换

## **功能描述**

1. 没有在线编辑插件 但是有在线预览插件（office文件）的情况下，在新建html文档页面，仍然展示【打开本地文件】按钮

2. 点击打开本地文件按钮，支持选择在线预览插件支持的文件类型，选择后将文件展示在正文内，进行预览

3. office正文新增切换预览插件功能

4. 系统新增记录用户上一次使用预览插件的功能

# **功能说明**

## **打开本地文件**

1. 点击打开本地文件按钮，支持选择office文件，选择后将文件展示在正文内，进行预览

2. 没有插件的情况下，也展示打开本地文件按钮，支持上传本地文件作为正文

![](c21ab58207878af640f019d66a78541f.jpg)

![](f1a192c9fb70e303dae8a3d9cbeabe8f.jpg)

![](38f5be4a39e1fbdad30593d383b1e257.jpg)

## **替换正文**

1. 编辑文档时支持替换正文

2. 自动保存： 在保存按钮右侧新增“替换正文”按钮，点击后打开本地文件，允许选择相同格式的文件，在本地文件浏览框点击确定后开始上传，上传成功后刷新正文区域，若用户未点击保存，则替换不生效

![](3d3c68507ff27cd7fe41f2b73775a392.jpg)

3. 手动保存：进入文档编辑状态，在保存按钮右侧新增“替换正文”按钮，其他逻辑同上

![](276493829fca63ccad14779d247e2398.jpg)

## **正文切换插件**

Office正文预览页面，增加切换预览插件功能，点击切换按钮，即可选择现有插件进行预览

![](cdb00e6b5769dc89cfe96260cf78f227.jpg)

## **插件记忆**

1. 用户预览文件时，优先根据后台设置的插件优先级调用插件

2. 若用户在预览时切换插件，后续再次预览时，将优先调用上次切换的插件进行预览