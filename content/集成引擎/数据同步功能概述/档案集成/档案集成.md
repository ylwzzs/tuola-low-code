---
aliases: ["1966616714416576162"]
title: 档案集成
created: 2025-07-15
modified: 2025-07-15
tags: ['集成引擎']
theme: 集成引擎
---

越来越多的客户采购了档案系统，客户期望OA系统内的内容，能自动归档到档案系统中，以便做统一的档案管理。

该功能主要与档案系统集成，满足流程、文档、建模等模块归档功能。提供给用户界面化操作，灵活配置归档数据源，可与外部档案系统集成。

## •[[#功能入口|功能入口]]

## •[连接配置](http://连接配置)

## •[[#数据过滤规则库|数据过滤规则库]]

## •[[#转换规则库|转换规则库]]

## •[[#归档方案设置|归档方案设置]]

## ◦[[#归档方式|中信档案]]

## ◦[[#紫光档案|紫光档案(数据库 + FTP)]]

## ◦[[#自由格式归档|自由格式归档]]

## ◦[[#数据库|数据库(通用)]]

## ◦[[#ESB触发归档|ESB触发归档]]

## ◦[[#文书定档案|文书定档案]]

## ◦[[#国标档案|国标档案]]

## ◦[[#量子档案P9|量子档案P9]]

## ◦[[#ecode自定义归档|ecode自定义归档]]

## •[[#归档日志|归档日志]]

**功能入口（付费功能）**

配置权限：集成中心-档案集成

功能入口：后端应用中心-集成中心-档案集成

![](28d959c1461ac021fa35d6d62d877af3.jpg)

**连接配置**

功能入口：后端应用中心-集成中心-档案集成-连接配置

![](a2a89e0feac42a05d5a34c0a7302a7e3.jpg)

1、名称：任意，可重复

2、配置项：FTP、SFTP、本地

1）FTP、SFTP

![](9c7f217d9cf24237cb67ef91ba04b57a.jpg)

² 服务器地址：必填，填写SFTP或FTP服务IP，例如192.168.42.100

² 端口：必填，填写SFTP或FTP服务端口，例如21

² 登录名：必填，填写可访问SFTP或FTP服务账号，例如administrator或root等

² 密码：SFTP或FTP服务账号的密码

² 文件路径：用于存放文件的FTP或SFTP服务路径

² 说明：任意

2）本地（云上不支持此配置项，仅本地部署方式支持）

![](4943967511184e675903ae72fba40ce3.jpg)

² 文件路径：存储文件的主路径，如档案集成服务部署于linux，即可填写路径为：/home/docfile

² 说明：任意

**数据过滤规则库**

功能入口：后端应用中心-集成中心-邮箱集成-数据过滤规则库

![](17913e2850557cbadd3a2a56eb39e7a6.jpg)

注册后可在归档方案设置-字段映射-归档数据过滤中被选择，该方案流程归档导出时，满足此条件的流程数据才会归档导出；不满足条件的流程数据不导出，归档日志状态记录为“数据过滤”

![](8327e195ff12df4e4ac42be80fe49c1e.jpg)

详细内容请见[[什么是数据过滤规则|《什么是数据过滤规则》]]

**转换规则库**

功能入口：后端应用中心-集成中心-档案集成-转换规则库（提供系统级别转换规则可直接使用）

![](8acff616f6856340e4ed56dfb4421858.jpg)

注：注册转换规则需要实现转换规则类，才可注册，新建的转换规则可在归档方案设置字段映射转换规则中使用；

详细内容请见[[什么是转换规则|《什么是转换规则》]]

**归档方案设置**

1、 功能入口：后台管理中心-档案集成-归档方案设置

![](0d04ffd41c317a5377aa1520e0e0e3d9.jpg)

2、 新建入口：

点击新建按钮，进入新建归档方案设置页面：

![](7a18408e053cde733f8d1017aaf1eb0e.jpg)

1）从空白新建（通用设置）

点击从空白创建按钮，进入详细版本的新建归档方案设置页面，可自定义选择**套件类型**及相关参数信息，此模式下所有的配置均为空，均需自行配置。

![](40f030756c82d9a32dd7a2c75bb47de8.jpg)

2）选择套件快速创建

由于标准已形成了已知的第三方系统档案同步方案套件，为了优化用户的使用体验，新建时，标准将已知套件形成了简易版新建模板，仅需配置档案同步需要的必要参数即可完成配置。

详细配置查看下方[[#归档方式|通用配置-归档方式]]说明

3、 通用配置如下：

1）数据源

a. 基本信息：

![](fc8d855ff544eeccaaf90c2327e78670.jpg)

² 名称：必填项，任意

² 数据来源：必填项，可选流程标准数据源

b. 选择流程标准数据源后，会出现工作流相关设置：

![](c0dbc43ff496d507b15eb305145b4128.jpg)

² 工作流类型：必填项，可选后端管理中心-工作流程-团队工作流列表所有的流程路径

² 工作流版本：可选对应流程路径所有版本

² 自动添加流程新版本：默认开启，开启：流程路径存为新版时，自动注册在方案中添加此版本；关闭：不自动添加，后续可手动添加

c. 流程文档导出设置：

![](53480c26fb0123a62513c338275642fe.jpg)

² 导出流程表单文档：默认关闭，

开启，归档时，导出流程中所有文档、附件、图片等；

关闭，不导出

² 仅导出最新的流程表单文档：

开启，如文档、附件、图片含有多个版本，即导出最新版本；

关闭，如文档、附件、图片含有多个版本，即所有版本；

² 导出文档为ZIP：

开启，如文档、附件、图片、签字意见文档、签章图片等，每一个文件压缩为ZIP；

关闭，不压缩为ZTP，保持原有文件形式；

² 导出流程文档路径：与连接配置中的文件路径拼接成文档的完成的路径，存储流程中的文档、附件、图片、签字意见文档等；可使用动态变量配置

支持以下形式的动态路径: /file/{workflowId}/{year} 支持的变量包括: {workflowId}【流程路径id】,{requestId}【流程请求id】,{deptId}【流程创建人部门id】,{creator}【流程创建人id】,{year}【归档时所属年份例如2023】,{month}【归档当时所属月份，例如05】,{day}【归档时所属日期，例如12】,{表单字段}【可取自流程表单数据库字段】，例如：/{year}-{month}-{day}/{requestId}/，归档时间为2023年12月02日，流程请求id为：4589，则文档将存储于路径：/2023-12-02/4589下

d. 流程表单导出设置：

![](bc8f6d110f692da7a2e6d238dfc68135.jpg)

² 导出流程表单为HTML：与“导出流程表单为PDF”可同时使用

开启，流程表单保存为HTML格式

关闭，不生成HTML格式的流程表单文件

² 导出流程表单为PDF：与“导出流程表单为HTML”可同时使用

开启，流程表单保存为PDF格式

关闭，不生成PDF格式的流程表单文件

² 导出流程表单路径：与连接配置中的文件路径拼接成文档的完成的路径，存储流程表单HTML、PDF；可使用动态变量配置

支持以下形式的动态路径: /file/{workflowId}/{year} 支持的变量包括: {workflowId}【流程路径id】,{requestId}【流程请求id】,{deptId}【流程创建人部门id】,{creator}【流程创建人id】,{year}【归档时所属年份例如2023】,{month}【归档当时所属月份，例如05】,{day}【归档时所属日期，例如12】,{表单字段}【可取自流程表单数据库字段】，例如：/{year}-{month}-{day}/{requestId}/，归档时间为2023年12月02日，流程请求id为：4589，则文档将存储于路径：/2023-12-02/4589下

² 导出表单布局来源：可选显示布局或打印布局，选择后，选择布局浏览框可选择流程路径中设置的模块

² 选择布局：选择某个布局后，即按照设置的布局导出流程html和pdf

² 导出流程意见：

开启，归档方式选择为“中信档案(XML + FTP)”、“自由格式归档”，流程归档导出生成的xml文件中包含签字意见等信息；

关闭，流程归档导出生成的xml文件中不包含签字意见等信息；

² 导出流程意见文档：

开启，流程流转过程中，签字意见中所有的文档可导出；

关闭，签字意见文档不导出

² 导出签章图片：开启，导出流程签字意见中的签章图片，关闭不导出

² 导出签章图片路径：存储导出的签章图片的路径；可使用动态变量配置

支持以下形式的动态路径: /file/{workflowId}/{year} 支持的变量包括: {workflowId}【流程路径id】,{requestId}【流程请求id】,{deptId}【流程创建人部门id】,{creator}【流程创建人id】,{year}【归档时所属年份例如2023】,{month}【归档当时所属月份，例如05】,{day}【归档时所属日期，例如12】,{表单字段}【可取自流程表单数据库字段】，例如：/{year}-{month}-{day}/{requestId}/，归档时间为2023年12月02日，流程请求id为：4589，则文档将存储于路径：/2023-12-02/4589下

e. 同步设置

![](480e2e174f83ea31027e9252fd05f918.jpg)

² 手动同步：可手动归档导出流程

² 手动同步和自动同步：可手动归档导出流程；可设置计划任务定时导出相关流程

2）归档方式

包含：中信档案、紫光档案(数据库 + FTP)、自由格式归档、数据库(通用)、ESB触发归档、文书定档案归档、国标归档

a. 中信档案

![](bd7b70576fa0404ca014dd6d1fa6276f.jpg)

² FTP连接配置：必填，可选连接配置中的配置

² 模板配置：默认模板

b. 紫光档案(数据库 + FTP)

![](bbc9f88febe7d45c7d7b4b653a2a2500.jpg)

² 数据源：必填，后端管理中心--数据源中维护的所有数据源信息

² 存储主表：必填，选择表存储流程表单字段相关信息

² 存储明细表：选择选择表存储流程表单附件相关信息

² 主键生成策略：自增（主表、明细表主键需设置自增）、分布式ID、UUID

² FTP连接配置：可选连接配置中的配置

c. 自由格式归档

![](4a3142bbd39161277b89e5389eb5743f.jpg)

![](d7199495b2c27b73ed32b3262d2e678d.jpg)

² FTP连接配置：必填，可选连接配置中的配置

² XML文件编码：可选UTF8、GBK、GB2312，生成xml文件的编码

² XML文件信息格式：可选FTP路径、Base64编码，xml中文件可以Base64编码的形式生成

² 模板配置：

² 文件名称：生成xml文件的名称，可自定义，例如：{requestId}.xml，即生成的xml文件名称为：585588.xml，注意要带后缀.xml

² 输出路径：Xml文件上传的位置，如果连接配置选的FTP，则xml文件将上传到:FTP连接配置的主路径+输出路径为文件的上传路径

² Xml模板：根据实际需要配置

d. 数据库(通用)

![](2adec063827de789cf651e25c342f3ec.jpg)

² 数据源：必填，后端管理中心--数据源中维护的所有数据源信息

² 存储主表：必填，选择表存储流程表单字段相关信息

² 主键生成策略：自增（主表、明细表主键需设置自增）、分布式ID、UUID

² FTP连接配置：必填，可选连接配置中的配置

e. ESB触发归档

![](46531ce3ef6a33d7f39509fd25190b40.jpg)

² FTP连接配置：可选连接配置中配置，选择FTP，即将文件上传至FTP；未选择，则不上传

此处注册后，可在ESB中心-动作流中新建动作流

![](63408843f5544e74a7d45a1b3bba38bb.jpg)

选择档案集成触发组件：

![](f6024a5dd770b81b5a12e27db0898805.jpg)

选择【ESB触发归档】的归档方案，添加触发事件：

![](6da43161e3368334998ea7d9cd432ac1.jpg)

后续动作流操作可根据实际配置，可调用外部接口，配置字段映射，将数据传输给第三方

![](04b5716327a670165b37ec47631cb514.jpg)

动作流配置完成后，在集成中心点击归档操作时，执行动作流，根据字段映射将数据传输出去

f. 文书定档案

![](6790fa5387d0bec02cb97a5b4afc37ba.jpg)

² FTP连接配置：必填，可选连接配置中配置

² XML文件编码：可选UTF8、GBK、GB2312，生成xml文件的编码

² XML文件信息格式：可选FTP路径、Base64编码，xml中文件可以Base64编码的形式生成

² 归档位置：可选预归档、接收库，两者区别在于带出模板配置中的默认模块不同，模板可自行调整

² 模板配置：根据选择的归档位置，默认带出，可自行修改

g.国标档案

![](e76b74267f3f911f103a5304ec9184e3.jpg)

² XML文件编码：可选UTF8、GBK、GB2312，生成xml文件的编码

² 版式文件格式：无输出、PDF【doc、xlsx等文件转换为pdf文件】、OFD【doc、xlsx等文件转换为ofd文件】

² 【Webservice注册地址】：档案管理系统接口地址

² 模板配置：根据选择的归档位置，默认带出，可自行修改

² 信息包名称：将导出的文件生成一个压缩包，对应压缩包名称，可自定义

信息包推送方式：

Webservice接口推送：

Webservice服务地址：档案系统接口地址

![](e353d85b57b7cbc6ed651daf36577046.jpg)

ecode自定义归档：

分组标识：ecode发布的dubbo接口gruop标识

版本号：ecode接口版本号

说明：任意

![](80f72c3ca3513b9a4cd7dd7ae801ef81.jpg)

i.量子档案P9

![](2190c1fa0a46e009df107f0e7698c327.jpg)

² 接口访问地址：档案管理系统接口地址，例如：192.168.45.25:8080

² 模板配置：根据实际需要可配置模板

j.ecode自定义归档

分组标识：ecode发布的dubbo接口gruop标识

版本号：ecode接口版本号

说明：任意

![](f3ff50067e722da5e8f1e03c3b631cd9.jpg)

3）映射与过滤（不同套件配置项不同）

![](66ab863924a5d746dc53ac21924a7ff4.jpg)

a. 字段映射

配置数据来源和数据目标的字段映射关系，相当于把外部数据的字段与OA的字段进行对应

![](a15f28fd54ad6d4126a029c96f815972.jpg)

² 主表：同步字段对应设置

来源字段：必填，可选流程表单所有流程相关的字段及特定字段

目标字段：字段映射中选择主表的所有字段（部分套件不涉及目标字段填写）

² 明细表：文档存储字段设置（部分套件不涉及明细表）

来源字段：必填，可选流程表单所有流程相关的字段及特定字段

目标字段：字段映射中选择明细表的所有字段

² 转换规则根据实际需要进行配置；转换规则支持选择类型：转换规则、函数公式与固定值

若转换规则选择【转换规则】，则后方为【转换规则选择浏览框】，内容为转换规则库中的内容，支持浏览框快速新建转换规则，点击跳转到新建转换规则页面

![](a7aa0ca6e836289094768d40fdb9b957.jpg)

若转换规则选择【固定值】，则后方为【输入框】，直接可输入固定值

![](ab61b792e86a43b38598d7cc30a9aab3.jpg)

若转换规则选择【函数公式】，则后方为【函数公式选择浏览框】，内容为函数库中公式列表的内容，支持浏览框快捷新建公式，点击新建公式跳转到新建函数公式页面,可新建函数公式及变量

![](f56401cf1171e31365594633c00960c1.jpg)

b. 文档类型值设置

对“主表：同步字段对应设置”中的文档类型设置固定值

![](01dd712bd4947abb3f27c89f7bb39f7f.jpg)

c. 字段过滤

² 全部有效：流程表单所有字段都可归档导出

² 黑名单：选中字段不导出

数据库（通用）、紫光档案（数据库+FTP）：黑名单可选流程表单主表、明细表中的图片、文档、附件等字段，选中即不导出此字段相关文档

中信档案、自由格式归档：可选流程表单主表、明细表所有字段，选择某个字段，即替换xml中变量时，值为空

d. 归档数据过滤

可选当前方案注册的数据过滤规则，**满足条件的进行归档导出；不满足条件的不导出，归档日志状态记录为“数据过滤”**

![](8fa7af179b0f80031f995b734658e24f.jpg)

![](e224904b014d39fa9f021576403495b7.jpg)

4）完成

点击“点此开始同步”“完成并开始同步”，可将所有符合条件的流程导出，导出结果可在归档日志中查看；

符合条件的流程说明：

|  |  |
| --- | --- |
| 归档日志中流程的状态为成功 | 不再归档导出 |
| 归档日志中流程的状态为失败 | 执行归档导出操作，同时更新原有归档日志所在批次记录成功或失败 |
| 归档日志中没有的记录的流程，同时此流程处于结束节点 | 执行归档导出操作，同时记录一个新的归档日志批次，包含符合此条件的所有流程 |
| 归档日志中没有的记录的流程，流程的当前节点不是结束节点 | 不归档导出 |

**归档日志**

“点此开始同步”“完成并开始同步”以及计划任务执行将所有处于结束节点的流程导出，并记录在归档日志中，若需要对已导出流程重复导出，可使用行菜单“归档”或批量归档

![](f92a39628af4027a0cb75565c68a4ce4.jpg)