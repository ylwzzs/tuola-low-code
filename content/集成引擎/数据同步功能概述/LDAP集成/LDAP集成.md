---
aliases: ["1963695853693358888"]
title: LDAP集成
created: 2025-07-15
modified: 2025-07-15
tags: ['集成引擎']
theme: 集成引擎
---

LDAP是一种通讯协议，LDAP支持TCP/IP。协议就是标准，并且是抽象的。在这套标准下，AD（Active Directory）是微软出的一套实现。我们可以暂且把它理解成是个数据库。

该功能主要实现：

1、实现 AD域认证登录：支持用户使用指定字段（需要唯一值） 域认证登录 OA的PC端；

2、实现 正向同步：同步AD组织和人员到OA；

3、实现 正向同步：同步OPENLDAP组织和人员到OA；

4、实现 反向同步：同步OA组织和人员到AD

5、实现 反向同步：同步OA组织和人员到OPENLDAP；

6、实现 基础设置支持管理分权；

7、实现 实时反向组织架构、人员到AD；

8、实现 实时反向组织架构、人员到OPENLDAP；

9、实现 账号管理，允许解绑OA人员和AD域的对应关系

10、实现 允许OA修改AD域中的密码

## •[[#功能入口|功能入口]]

## •[[#基础设置|基础设置]]

[[#配置详情|配置详情]]

[[#配置详情|基础设置]]

[[#认证信息|认证信息]]

[[#修改密码|修改密码]]

[[#正向同步|正向同步]]

[[#反向同步|反向同步]]

[[#完成|完成]]

[[#同步页面|同步页面]]

[[#预览与查询|预览与查询]]

## •[[#数据过滤规则库|数据过滤规则库]]

## •[[#转换规则库|转换规则库]]

## •[[#函数库|函数库]]

## •[[#认证管理|认证管理]]

## •[[#同步日志管理|同步日志管理]]

**功能入口**

【后台管理中心】-【集成中心】-【LDAP集成】

![](2329f5bae9bd9565d0f07ae7fabc1351.jpg)

**基础设置**

1、点击新建按钮，进入新建LDAP集成设置页面：

![](04d824c108128716ec98e2eccfe0eafb.jpg)

1）从空白新建（自定义设置）

点击从空白创建按钮，进入新建LDAP集成的初始化页面，开启开关代表启用该功能，初始化模板会自动跳过未开启功能的配置页面。

![](fa29fe224fa0c81bd8d089003ddede4d.jpg)

2）选择套件快速创建

由于标准已形成了对接方案套件，为了优化用户的使用体验，新建时，标准将已知套件形成了简易版新建模板，仅需配置必要参数即可完成配置。

2、配置详情

a.基础设置

![](ea21efc487d3391aeb43af3b5a37ad83.jpg)

启用：开关开启，才可与AD服务器连接，实现后续的正向同步功能；

名称：随意取，不重复即可；

类型：AD、OpenLDAP、SunOne，选择需要的即可

连接超时/读取超时：设置超时判定时间，响应时间超过设置的内容时，即为超时（输入0表示不限制）

分页查询：开关开启则使用分页查询AD数据，需要AD服务器支持分页查询；分页数默认为300，可以自行调整，最大为500；

开启SSL：关闭，暂时用不上，后期功能支持会更新文档；

域服务器地址：AD服务器的地址，AD域提供；

端口号： AD服务端口，默认为389；

基础DN：AD服务器的基础DN，AD域提供；

域名：AD服务器的域名，AD域提供；

登录名：可用于连接AD服务器的AD账号密码，AD域提供；

密码：可用于连接AD服务器的AD账号密码，AD域提供

**设置完需点击【下一步】按钮才能保存数据**

b.认证信息

![](b6c5066a255faa2744d8c4dcec54e944.jpg)

启用：开关开启，才可使用LDAP认证功能；

**LDAP认证属性：根据基础设置中LDAP类型配置，自动带出默认LDAP认证属性**

当基础信息中的类型为AD时，默认为sAMAccountName

当基础信息中的类型为openldap时，默认为uid

LDAP认证属性可根据实际情况调整。支持浏览按钮选择AD属性，也可以点击切换按钮后，手动输入AD属性；属性字段里的内容值需要和OA的**账号字段**内容匹配，且AD中这个字段需要是唯一值

![](12b25cba30c28e2c564e3c3ab6b2d4e9.jpg)

注意：若开启了修改密码功能，该字段需要和修改密码中的账号属性字段保持一致，否则会有提示信息

![](421d962cce30ed2f82966bced5b7cc6d.jpg)

**认证范围：根据基础设置中基础DN配置，自动添加一条默认的认证范围**

可根据实际客户需求进行手动修改。认证范围由AD域提供，保证所有 使用域认证的人员都在认证域的范围内即可

c.修改密码

![](13c3bb134365eae6c6afea7e7f417cf2.jpg)

启用：开关开启，才可使用修改密码功能

默认证书：默认开启，关闭可以自行设置证书、密码

证书路径：输入AD的导入证书（云端无法设置证书，建议私有化时才使用）

证书密码：输入AD的导入证书的密码

端口号：默认636，openldap时为389，可根据实际情况调整

账号属性：**根据基础设置中LDAP类型配置，自动带出默认账号属性**

当基础信息中的类型为AD时，默认为sAMAccountName

当基础信息中的类型为openldap时，默认为uid

账号属性可根据实际情况调整。支持通过浏览按钮选择AD属性，也可点击切换按钮后，手动输入AD属性；属性字段里的内容值需要和OA的**账号字段**内容匹配，且AD中这个字段需要是唯一值

![](12b25cba30c28e2c564e3c3ab6b2d4e9.jpg)

注意：若开启了认证功能，该字段需要和认证信息中的Ldap认证属性字段保持一致，否则会有提示信息

![](421d962cce30ed2f82966bced5b7cc6d.jpg)

密码属性：当基础信息中的类型为AD时，默认为unicodePwd；当基础信息中的类型为openldap时，默认为userPassword

修改密码注意事项：

当OA用户修改密码时，会遍历当前OA用户所有租户下的所有AD配置，只要满足以下2个条件，即会修改AD中的密码：

1）AD的基础设置、修改密码功能均为开启状态

2）通过账号属性字段可以找到AD域中有和当前OA用户匹配的账号

3）修改openldap密码时，需要在基础设置中关闭分页查询，否则修改密码会失败

![](f9a1c15ead095ac4036b12c6972a28c7.jpg)

d.正向同步

![](a77492aa7b5f5ba70cccd6f03990346b.jpg)

启用：开关开启，才可使用正向同步功能

字段对应设置：**根据基础设置中LDAP类型配置，自动带出默认的分部、部门、人员字段对应设置（默认使用LDAP组织层级同步方式）**

当基础信息中的类型为AD时，默认分部、部门、人员字段对应设置：

![](e64a8e78e95d6942d208a28ba32ee2df.jpg)

当基础信息中的类型为openldap时，默认分部、部门、人员字段对应设置：

![](891367bcba7c494af6956b219452a40c.jpg)

1）LDAP属性：选择AD的属性字段，可以通过浏览按钮选择，也可以点击切换按钮后，手动输入属性；

2）OA字段：选择OA的属性字段，OA支持的同步的字段根据版本迭代自动更新

人事档案字段设置：

![](2b27c88c285c4d2aa8f62471c2389444.jpg)

自定义字段设置：

![](b6a40219950735d58f129c34fcbd0d48.jpg)

3）操作类型：选择同步操作的类型，无限制、仅添加、仅修改；

无限制：可以进行数据的新增、更新

仅添加：只能新增数据

仅修改：只能修改已有的数据

4）转换规则：字段映射配置里，转换规则支持选择类型有转换规则、函数公式与固定值

![](03dd5fb01037ae7a20f8c0fd24171d43.jpg)

若转换规则选择【转换规则】，则后方为【转换规则选择浏览框】，内容为转换规则库中的内容，支持浏览框快速新建转换规则，点击跳转到新建转换规则页面，具体维护查看[[什么是转换规则|《帮助文档-转换规则库》]]

![](b63c566cbecac9b7eca6871217ee0117.jpg)

若转换规则选择【固定值】，则后方为【输入框】，直接可输入固定值

![](75a54dd7d92b2235d17fe3409ee65ccd.jpg)

若转换规则选择【函数公式】，则后方为【函数公式选择浏览框】，内容为函数库中公式列表的内容，支持浏览框快捷新建公式，点击新建公式跳转到新建函数公式页面,可新建函数公式及变量

![](f557d5fb037b0ac90457864f978e231e.jpg)

5）数据过滤

支持分别配置这三项内容的数据过滤规则：

|  |  |
| --- | --- |
| 参数名 | 参数值 |
| 分部数据过滤规则 | 1. 组织架构设置-基础设置-启用分部，开启此配置展示，未开启，此配置不做展示  2. 设置分部数据过滤规则，只同步满足过滤条件的分部  未设置分部数据过滤规则，根据同步数据范围做全量同步 |
| 部门数据过滤规则 | 1. 设置部门数据过滤规则，只同步满足过滤条件的部门  2. 未设置部门数据过滤规则，根据同步数据范围做全量同步 |
| 人员数据过滤规则 | 1. 设置人员数据过滤规则，只同步满足过滤条件的人员  2. 未设置人员数据过滤规则，根据同步数据范围做全量同步 |

6）主键：单选：

LDAP层级只支持AD的objectGUID同步到LDAP同步字段作为主键，自定义层级同步支持任意主键，需要保证主键对应的AD属性值不重复即可。

OPENLDAP层级只支持AD的entryUUID同步到LDAP同步字段作为主键，自定义层级同步支持任意主键，需要保证主键对应的AD属性值不重复即可。

人员字段对应关系需要指定账号字段，否则需要后期在AD中维护对应内容和OA中生成的随机账号匹配。

同步节点：

![](81436ed3f7ce0f4bb252ebcb19db9dea.jpg)

1）同步域：Ldap中的域同步范围，配置域节点对应的distinguishedName属性值(AD管理员提供)；

2）同步组织结构：开关开启，同步域下的OU将作为部门同步到OA；

3）同步条件：默认为(|(objectClass=organization)(objectClass=organizationalUnit))；当采用组同步模式时，同步条件需要修改为：（objectClass=group）

4）同步人员：开关开启，同步域下的人员会同步到OA；

5）同步条件：当基础信息中的类型为AD时，默认为(&(|(objectClass=user)(objectClass=person))(!(objectClass=computer)))；当基础信息中的类型为openldap时，默认为(|(objectClass=person)(objectClass=organizationalPerson))

6）操作类型：

无限制：根据配置同步所有数据

仅添加：OA无此人员，AD有此人员时，新增人员；OA有此人员，AD有此人员，不对OA数据进行更新操作

仅修改：OA无此人员，AD有此人员时，不新增OA人员；OA有此人员，AD有此人员，更新OA人员

7）组模式：采用组模式同步时，需要开启，同时需要关闭使用LDAP组织层级开关

定时同步：

![](630c5ff6785958190bd60497969a4733.jpg)

1）启用：默认关闭，如果需要定时同步，则开启开关；如果不需要则无需配置此处；

2）全量同步：不用设置，目前只支持全量同步，开关暂时无效，后期支持正能量同步后更新文档；

3）定时时间：默认值为 0 0 1 \* \* ? 表示每天凌晨一点自动执行同步；点击【设置】按钮出现设置窗，**设置完成后，需点击【确定】按钮**

注意：

**如果客户环境是私有化部署，需要在系统管理--任务调度中心--回调管理处新增配置**（只需配置一次即可）：

模块：intcenter\_ldap

方法：ldap\_sync

回调地址：<https://域名/papi/intcenterldap/syncin/ldapSyncTask>![](a85d6a4977a424bae8b5489b23eb3113.jpg)

e.反向同步

![](0e35c09ec4cafde8802a0b0e9f844b7d.jpg)

启用：开关开启，才可使用反向同步功能

实时同步：默认关闭，开启后修改OA部门、人员时实时反向同步到AD

字段对应设置： 根据基础设置中LDAP类型配置，自动带出默认的分部、部门、人员字段对应设置（默认使用LDAP组织层级同步方式）

当基础信息中的类型为AD时，默认分部、部门、人员字段对应设置：

![](f18f5b83ff4c49035100acf83f781503.jpg)

当基础信息中的类型为openldap时，默认分部、部门、人员字段对应设置：

![](727c032bd67478a8545a0ca5770c83ff.jpg)

1）OA字段：选择OA的属性字段，OA支持的同步的字段根据版本迭代自动更新 （人员同步字段对应设置中的OA字段不要选“账号”字段，它无法作为源数据同步）

2）LDAP属性：选择AD的属性字段，可以通过浏览按钮选择，也可以点击切换按钮后，手动输入属性；

当基础信息中的类型为AD时，人员字段对应关系建议同步sAMAccountName字段，否则同步新增AD人员时，会产生一个随机账号

当基础信息中的类型为openldap时，人员字段对应关系默认使用uid字段

3）操作类型：

无限制：可以进行数据的新增、更新

仅添加：只对新增数据生效

仅修改：只能修改已有的数据

同步节点：

![](f6308feca1f3a760220f19b007328b22.jpg)

**指定反向同步的范围，同步的数据将作为下级组织/人员同步到指定的同步域下**

LDAP标识属性设置

当基础信息中的类型为AD时，默认分部、部门、人员LDAP对应标识设置：

![](7e20c60760409d0a038bb4ba93b38f90.jpg)

当基础信息中的类型为openldap时，默认分部、部门、人员LDAP对应标识设置：

![](327cf9e16cfc48b836a827d5905a37d9.jpg)

1）LDAP分部域标识：默认是OU，OPENLDAP类型下需要根据实际调整

2）LDAP分部对应OA字段：选择OA的属性字段，OA支持的同步的字段根据版本迭代自动更新，此处需要选择一个同级下唯一值的字段，否则会影响反向同步数据

3）LDAP分部对应ObjectClass：默认是top;organizationalUnit，OPENLDAP类型下需要根据实际调整

4）LDAP部门域标识：默认是OU，OPENLDAP类型下需要根据实际调整

5）LDAP部门对应OA字段：选择OA的属性字段，OA支持的同步的字段根据版本迭代自动更新，此处需要选择一个同级下唯一值的字段，否则会影响反向同步数据

6）LDAP部门对应ObjectClass：默认是top;organizationalUnit，OPENLDAP类型下需要根据实际调整

7）LDAP人员域标识：默认是CN，OPENLDAP类型下需要根据实际调整

8）LDAP人员对应OA字段：选择OA的属性字段，OA支持的同步的字段根据版本迭代自动更新，此处需要选择一个同级下唯一值的字段，否则会影响反向同步数据

9）LDAP人员对应ObjectClass：默认是top;person;organizationalPerson;user，OPENLDAP类型下需要根据实际调整

**注：同级下唯一值指的是，例如：同一个分部下不会允许有重名的同级分部、部门；同一个部门下不允许有重名的同级部门、人员**

**定时同步同正向同步的说明**

f.完成

此页面作用是，对前面的配置进行测试，测试失败则不允许同步，测试结果处会有简单的错误原因提示

![](4bd08a296128712ea19ee2e5a0a2a0a2.jpg)

基础设置和正向同步 测试通过后，可以点击【完成并进入同步页面】按钮，进入同步页面：

![](6e2a5a3bb83063741a3ebdd819181900.jpg)

3、同步页面

在同步页面，点击【开始同步】按钮，即可同步：

![](f933c32f38d0d51f842eb366312734f9.jpg)

同步完成后，可点击【查看详情】跳转到 同步日志 页面，查看详细的同步情况：

![](6790ff9d3e05a468b9429b7c98a88f36.jpg)

说明：反向同步OpenLDAP因为仅支持叶子节点修改DN操作，非叶子节点会重命名失败，所以当分部或部门为最后一级，没有下一级时可以进行名称修改更新

![](21ee94ef55128968a73a4dd54f2d95bf.jpg)

4、预览与查询

![](d481ae80927ae48ee46f4ba01123579a.jpg)

配置LDAP基础设置，测试通过后点击行菜单或完成页面【预览与查询】，即可过OA直接查看、搜索LDAP中的数据。

说明：

1）点击【预览与查询】，需要测试当前配置内容【基础设置】是否测试通过

若测试未通过，会进行弹窗提示：

![](55732df357be9bac674a29f7f0b25a7a.jpg)

2）若测试通过，则打开【预览与查询】弹窗（弹窗括号内，展示当前配置名称）

3）默认进入时，选中根节点并展示根节点对象属性（根节点为当前设置中，基础设置-基础DN内的值）。根节点默认收起，展示开时加载数据。

未选中对象时，左侧页面进行提示：

![](186858f2dcf08b21e1aa83f7f4e8e7e2.jpg)

选中对象时，左侧页面展示选中对象属性：

![](45120efaa7da0a518db9515655e56d05.jpg)

4）对象查询支持手动输入属性名与属性值的单条件查询，也支持切换自定义filter查询

5）属性名与属性值均为输入框形式，属性名支持模糊查询。匹配条件支持【等于】、【不等于】、【包含】、【不包含】、【大于】、【小于】、【为空】、【不为空】

6）查询结果中的对象展示名为【distinguishedName】，不展示层级关系

条件查询：

![](42b3329129eff533e1f5dc0810161807.jpg)

自定义filter语句查询：

![](6888acee6af2b5c32d9f77f0ed7a5bb6.jpg)

未查询或未查询到结果时，页面无展示数据：

![](135617b9c6fa88213277a134ef743c7c.jpg)

5、复制![](5dbf19bf646a5a9158d27c1845afc205.jpg)

LDAP配置一键复制成功后，默认生成一条新的数据，名称为“原数据名称”-“当前时间（年月日时分秒）

**数据过滤规则库**

功能入口：后端应用中心-集成中心-LDAP集成-数据过滤规则库

![](fe18b2d48eeaa98fc98b286e7796725e.jpg)

详细内容请见[[什么是数据过滤规则|《帮助中心-数据过滤规则库》]]

**转换规则库**

对于外部的数据, 可能和OA的数据类型不对应, 需要做转换或者需要给固定值或者是进行字符串拼接等, 此时需要配置转换规则

详细内容请见[[什么是转换规则|《帮助中心-转换规则库》]]

**函数库**

函数库内展示LDAP集成的所有相关数据

![](2537bbd124d24854ed015843df4d8194.jpg)

页面可新建公式及自定义函数,新建的数据会展示在列表里,HR同步选择函数公式时,可选到相对应的函数公式设置

**认证管理**

分为账号管理和报错提示两个页面

![](6db76195ec234c52dca74af38c5a2cf8.jpg)

账号管理：账号支持手动绑定、支持切换、解绑和批量解绑操作

当OA人员第一次采用域登录方式登录后，默认会与某一个域做绑定关系，如果出现某个OA用户在多个域有对应账号的情况，而当前绑定域信息不是预期的域，可以在这里做切换或解绑操作，达到和新的域信息绑定的效果

报错提示：

![](dd3213b7edab2132103d25bdc34b7c19.jpg)

当未设置自定义提示时，系统会根据AD用户登录的返回编码（即错误码）进行判断并给出指定的提示信息

![](658854eebc0a4091bd1884f90281a13c.jpg)

当设置自定义提示时，系统会根据AD用户登录的返回编码（即错误码）进行判断并给出个性化设置的提示信息

![](145bb192cd85dc75ec92eb5cdd1b492d.jpg)

无论是否设置了多语言格式的提示信息，右上角的保存按钮必须点击后，对应的配置才能真正生效

**同步日志管理**

分为同步日志和定时清理两个页面

![](d512f5d0ceb21245346cdfc1c005eb97.jpg)

同步日志：点击详情列的 查看 可以看同步详情，同步失败的数据会有简单的原因提示

![](bd6fb34224c190926f7c3bde17339698.jpg)

定时清理：启用后通过配置保留日志天数,清理当前日期x天前的日志数据,支持输入1-1000内的正整数进行配置。清理动作每天零点执行

![](ceae32a10f2d0a95cd4a69ff7f859a93.jpg)