---
aliases: ["2510698625668221941"]
title: 产品出库提交时获取最新库存校验
created: 2025-07-15
modified: 2025-07-15
tags: ['表单引擎']
theme: 业务表单
---

## •[[#场景介绍|场景介绍]]

## •[[#操作步骤|操作步骤]]

## ◦[[#新建校验规则|新建校验规则]]

## ◦[[#配置校验规则|配置校验规则]]

## •[[#实现效果|实现效果]]

**场景介绍**

某公司产品出库时需要提交出库表。出库表中关联钻取产品信息表的库存数据，方便同时查看到实时的库存数据。

由于产品库存数量短期内变动较大，因此在数据暂存后再次填写提交时，会出现已经钻取显示出来的库存数据与实际库存数据不一样的情况，会对业务造成影响。

**产品信息表**：

![](8b5fe9799bd79fa3a063b1d329145047.jpg)

**出库表**：

![](f58e8b115f06328239b83dfbb6982acc.jpg)

**操作步骤**

为保证在提交时关联出来的数据是最新的产品库存数据，需要在提交表单时进行数据校验。

若出库表中钻取显示出来的产品库存数量和出库表中的库存数量不一样，则提醒“产品信息有变化，请重新选择关联产品进行更新~”。重新选择关联产品后，钻取出来的库存更新为最新的库存数据，再提交出库表。

## ◦ 新建校验规则**

新建规则如下，选择函数规则添加函数公式，不满足校验内容时提示语为“产品信息有变化，请重新选择关联产品进行更新~”

了解更多：[[待下载-未知ID_1582842873979163738|数据校验]]

![](4fc84da6ecee196c38f4c6afff382102.jpg)

函数公式：**COUNT({产品信息表},AND({产品信息表.产品名称}=TEXT({当前数据.选择产品}),{产品信息表.单价}={当前数据.单价}))>0**

该公式表示产品信息表中，产品名称等于当前选择产品的名称，并且数量等于当前数据的库存的数据数量大于0（即有符合条件的数据）。

了解更多：[[待下载-未知ID_1588632682705218023|校验函数说明]]

![](dc74067c120ef15979779704e3425332.jpg)

## ◦ 配置校验规则**

在出库表的触发规则设置中添加规则，位置如下图

了解更多：[[触发规则设置（规则库已不维护，通过动作流实现）|触发规则设置]]

![](dee4de5f15ea9f554c6bc6ff4ea8f667.jpg)

配置规则如下

![](1ab7217bc7d468d5aac56513f4d52bc3.jpg)

**实现效果**

暂存出库单后，修改产品信息表中对应的产品数量。再回到出库单中进行提交，校验不通过，进行提示。按照提示重新选择产品后提交即可。

![](4e63fc20e9dcfd3efa81df77cef8e2d2.jpg)

![](f20e32f6f5c7d78369f73305dd7545d0.jpg)

![](a13d36625770507c16d3565311779aac.jpg)