---
aliases: ["1965571483441703329"]
title: 如何写公式
created: 2025-07-15
modified: 2025-07-15
tags: ['表单引擎']
theme: 业务表单
---

- [[#新建公式|新建公式]]
- [[#语法说明|语法说明]]
- [[#常见错误示例|常见错误示例]]
- [[#复制公式|复制公式]]

本文将介绍如何编写一条公式，公式中涉及的内容规范以及常见的错误示例。

其中公式的语法与 Excel 中的公式语法十分类似，函数的用法也很相近，如果会使Excel的函数，将会大大减少学习成本。

**新建公式**

新建公式有多个入口，通过不同的入口进入设置的内容有所不同。

**1、通过公式列表新建公式：**

点击公式列表，可以新建引用类型不同的公式，点击【下一步】进入公式表达式编写页面。

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/d9aa51f44314308a4bc8b35655e4e89b.jpg)

**2、通过表单设置/表单编辑器新建公式：**

点击表单设置/表单编辑器中的【新建公式】按钮，可以新建空白的公式。

注意：此处限制了公式类型，默认生成的公式的引用类型为赋值类型，点击后直接进入公式表达式编写页面。![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/fe6a97b9253c42304e8f4ac58efa27ab.jpg)

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/896a13e279a781f08589986a73508440.jpg)

**3、如何写入变量：**

在 [[公式中的变量与常量|变量]] 中我们说过，变量不可通过复制的方式引用。那么应该如何插入变量。

鼠标移入到表单名称上，点击可以直接选择该表单为一个变量。

鼠标移入表单名称后的“>”icon，点击可以下钻展开该表单的字段变量。

鼠标移入模块名称后的“>”icon，点击可以下钻展开该模块内的表单。

注意：变量的写入格式为“{}”不可删除对应的花括号，否则将无法识别。

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/cbbef4fdc0a2fac0c713335301c7bd9c.jpg)

**4、如何写入常量：**

将光标移入想要插入常量的位置，可以通过键盘键入的方式书写常量。

写入的常量会用蓝色显示。

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/c3fa41f97124642d846080f38894a48e.jpg)

**5、如何使用函数：**

**显示提示：**

对于插入的函数将光标移入不同的函数内部，可以显示对应的函数提示。

函数提示中包含函数的使用格式、使用说明以及使用示例。

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/59c27a482f2745d2f554b925f0d3c34d.jpg)

**使用说明：**

鼠标移入变量类型后的“>”icon，点击可以下钻展开该类型下的函数。

点击函数，会自动带入该函数的默认格式。

之后根据函数提示的格式进行内容的书写。若函数内输入的内容不符合当前函数的使用规范，将会导致函数错误，进行报错提示。

注意：函数使用时，必须含有对应的括号。

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/3839284adb8587f321b5abb6bd7f301c.jpg)

**语法说明**

在我们书写公式表达式时，需要遵从一定的语法格式，否则公式将执行错误。

**1、需要采用英文输入：当我们输入","或引号时，需要采用英文输入法，不可使用中文输入，否则将识别失败。**

中文符号无法被识别。

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/263431883b425bbe82a86ea71003a1d7.jpg)

**2、引入参数时，可以用双引号也可以用单引号（英文输入法），均可以被识别。**

识别成功的内容，将会显示为绿色。

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/4ff3809876d7f0b011c485d77f718fd6.jpg)

**3、条件的写法**

在很多复杂的业务场景中，我们可以通过条件语句来实现复杂的场景。

如使用IF函数，IF函数的格式为IF（条件，表达式1，表达式2），即IF函数内需要写入判断条件，以及该判断条件返回的结果。

①条件表示计算结果为 TRUE 或 FALSE 的任意值或表达式。

写入格式：{参数}{比较运算符}{参数}。

参数可为常量或变量，比较运算符可使用任何比较运算符。

②表达式1表示 条件 为 TRUE 时返回的值。

③表达式2表示 条件 为 FALSE 时返回的值。

如：工作时长大于8时，返回 加班，否则返回 未加班。

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/7092cf508545b7555046adc7e071f48f.jpg)

**4、函数的嵌套使用**

在某些情况下，可能将某函数作为另一函数的参数使用。

嵌套函数顾名思义就是在一个函数里面再嵌套一个或多个函数。

函数体中代码都是自上而下执行的。

如：我们编写一个函数，在CONCAT()函数中嵌套一个GETHRMNAME()函数和GETHRMMOBILE()函数，那么此时处于最外部的CONCAT()函数叫做外部函数，GETHRMNAME()函数和GETHRMMOBILE()函数叫做内部函数。

我们可以看到下图中最终输出结果是先输出"外部函数"，再输出"内部函数"。因为内部函数GETHRMNAME()函数和GETHRMMOBILE()函数的调用在CONCAT()函数("外部函数")语句后面，所以会先输出"外部函数"。

注意：函数只有调用后才起作用。

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/b380bcbe6e87136930dff0d09c0c9df6.jpg)

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/fa608ced3272232290a0de23734f5464.jpg)

使用嵌套函数还需要注意，不要少了对应的括号，括号都是成对出现的。

同时，嵌套层数不宜过多，否则可能会导致公式执行失败。

**常见错误示例**

**1、参数类型错误：**

如IDCARD()函数中，第二个参数应为查找类型，并在提示中注明可以填写的类型，而这里我们输入了没有的"BC"，于是在保存时会进行错误提示，不允许保存。

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/ff82cd3e07d4307dc1e1ea41f09940c2.jpg)

**2、缺少闭合的括号：**

CONCAT()函数缺少右边的括号。

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/65192245ca6dad3a6009025250c5e7fd.jpg)

**复制公**式**

在同一个表单中配置公式时，往往不同字段会使用同一个公式或类似公式，写重复公式比较费时。故增加同表单公式复制功能，可快速复制到其他字段上，不用调整或微调即可使用。

**操作说明**

1、新增复制按钮

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/4a8c17386eb7cc977d5537ec61b90296.jpg)

2、复制函数公式：点击复制按钮，复制成功后会给出提示

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/97ff32c2a3adabb5a8131509fa2e559c.jpg)

3、粘贴函数公式：鼠标右键粘贴，或者直接ctrl+V粘贴

![](https://myhelpdoc.oss-cn-heyuan.aliyuncs.com/mdimages/d2bf18b61df0cd8f39d27527deeb4337.jpg)

4、粘贴后保存成功，此公式即可正常使用

