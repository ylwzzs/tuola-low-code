---
aliases: ["1964076822255485346"]
title: 公式中的函数
created: 2025-07-15
modified: 2025-07-15
tags: ['表单引擎']
theme: 业务表单
---

- [[#什么是函数|什么是函数]]
- [[#聚合函数|聚合函数]]
- [[#逻辑函数|逻辑函数]]
- [[#字符函数|字符函数]]
- [[#比较操作符|比较操作符]]
- [[#日期函数|日期函数]]
- [[#数学函数|数学函数]]
- [查找函数](http://查找函数)
- [[#数据库函数|数据库函数]]
- [[#财务函数|财务函数]]

**什么是函数**

函数是指一段可以直接被另一段程序或代码引用的程序或代码。我们可以通过函数对数据进行快速处理，由于用途不同，我们对于函数进行分类，当前提供多类函数。

**聚合函数**

**说明**

对某个表中涉及到的数字类型控件进行聚合操作，如找最大值、最小值、求和、取平均数等。

**函数详情**

COUNT(表格,聚合条件)：返回指定表格中满足条件的数据条数，支持数据过滤。

示例1：COUNT({员工表}) 计算员工表的数据条数；

示例2：COUNT({员工表}，AND({员工表.姓名}={来源表.姓名})) 计算员工表中，满足条件的数据条数。

SUM(数字字段)：返回指定表格中满足条件的数据，其指定数字字段值的总和。统计条件中不可嵌套使用统计函数。

示例：SUM({员工表.工资})

AVG(数字字段)：返回指定表格中满足条件的数据，其指定数字字段值的平均值。统计条件中不可嵌套使用统计函数。

示例：AVG({员工表.工资})

MIN(表格)：返回指定表格中满足条件的数据，其指定数字字段值的最小值。统计条件中不可嵌套使用统计函数。

示例：MIN({员工表.工资})

MAX(表格)：返回指定表格中满足条件的数据，其指定数字字段值的最大值。统计条件中不可嵌套使用统计函数。

示例：MAX({员工表.工资})

**逻辑函数**

**说明**

判断某些控件的值是否符合预期，并执行相关后续操作。

**函数详情**

IF(条件,表达式1,表达式2)：如果条件为真，则执行表达式1，为假则执行表达式2。条件中不可嵌套使用IF函数。

示例：IF({员工表.年龄} > 60, '退休', '在职')、IF({员工表.年龄} > 60, IF({员工表.性别} = {员工表.性别.女}, '退休', '在职'), '在职')

NOT(逻辑结果)：对逻辑结果取反；

示例：NOT(2>3)

OR(条件1,条件2,[条件3, …]) : 任意一个条件为真，则返回真，否则返回假。逻辑操作OR的函数模式。

示例：OR(2 = 2, 2 > 3)

AND(条件1,条件2,[条件3, …])：所有条件均为真，则返回真，否则返回假。逻辑操作AND的函数模式。

示例：AND(2 = 2, 2 < 2)

IN(变量,[变量1,变量2, …])：任意类型的变量或常量等于一组同类型变量或常量结果中的任意一个，则返回真。

示例：IN(2, [2, 3, 4])

LIKE(文本,[文本1,文本2, …])：文本类型的变量或常量包含一组文本类型变量或常量结果中的任意一个，则返回真。逻辑操作LIKE的函数模式。

示例：LIKE('大家好', ['大家', '好'])

ISEMPTY(变量)：变量为空或未填写，则返回真。

示例：ISEMPTY({员工表.电话})

TRUE()：返回真。

示例：TRUE()

FALSE()：返回假。

示例：FALSE()

IFS(): 多个条件判断,位于单数位置的参数设置为条件，位于双数位置的参数设置为结果，最后一个参数为默认返回值，当所有条件都不满足的时候返回默认参数。

IsINT()：判断对象是否是整数。函数的参数不能为空。

示例：IsINT(参数)。

IsNUMBER()：判断对象是否是数字。函数的参数不能为空。

示例：IsNUMBER(参数)。

IsSTRING()：判断对象是否是JSON字符串。函数的参数不能为空。

示例：IsSTRING(参数)。

IsJSON()：判断对象是否是JSON字符串。函数的参数可以是数组、字符串；参数为数组时数组中必须只包含一个字符串。

示例：IsJSON(参数)。

**字符函数**

**说明**

对字符类型的控件的内容做运算操作。

**函数详情**

CONCAT(文本1,文本2,[文本3, …])：可用于连接多个任意类型的文本、日期、数字变量或常量。

示例：CONCAT({总价}/10000, '万元')

TEXT(变量)：将变量转为文本。

示例：TEXT({当前数据.性别})

结果： '男'

VALUE(文本)：将文本转为数字。

示例：VALUE('23元')

结果： 23

LEN(文本)：返回文本的长度，中文、英文都算1个字符。

示例：LEN('大家好dajiahao')

结果： 11

SEARCH(关键字,文本,[搜索开始位置])：在指定文本中查找关键字，返回第一次出现关键字的字符位置，文本的第一个字记为1。未找到，返回0。搜索开始位置，表示从文本的第几个字符开始搜索，默认为1。

示例：SEARCH('大家', '大家好大家好', 3)

结果： 4

REPLACE(原文本,替换开始位置,替换字符数,新文本)：在原文本中，从替换位置开始，往后数指定的替换字符数，将这段文本替换为新文本。

示例：REPLACE('大家好大家好', 2, 3, 'dajia')

结果： '大dajia家好'

REPT(文本,重复次数)：将文本重复指定次数。

示例：REPT('大家', 2)

结果： '大家大家'

PAD(原文本,长度,填充用的文本,['填充位置'])：将原文本填充到指定长度，如果文本长度大于设置的长度，则不做任何操作。填充位置可用参数：'LEFT'、'RIGHT'。

示例：PAD('你好', 4, '你', 'LEFT')

结果： '你你你好'

TRIM(文本)：删除文本首尾的空格。

示例：TRIM(' 大家好 ')

结果： '大家好'

LEFT(文本,截取字符数)：从文本左侧开始，返回指定字符数的文字。

示例：LEFT('大家好', 2)

结果： '大家'

RIGHT(文本,截取字符数)：从文本右侧开始，返回指定字符数的文字。

示例：RIGHT('大家好', 2)

结果： '家好'

MID(文本,指定位置,截取字符数)：从文本指定位置之后开始，返回指定字符数的文字。

示例：MID('大家好', 2, 1)

结果： '家'

INCARD(身份证号码，操作类型): 从身份证号码中获取相关信息，比如：生日（BD）、年龄（AGE）、籍贯（NA）、性别（GENDER）。

示例：IDCARD( ‘43070319980706334X’,‘BD’ )

结果： '1998-07-06'

SCORE(变量)：获取选项型控件（单选框、复选框、下拉菜单）分数。

示例：SCORE({当前数据.单选框})

结果：选项分数

注：未设置选项分数时，结果为0

ISSTRING({任意控件})：判断是否是字符。

示例：ISSTRING('泛微123456')  
结果：true

ISJSON({变量})：判断是不是JSON字符串，参数可以是数组，也可以是字符串，参数为数组时数组中必须只包含一个字符串。

示例：假设文本控件={a:123},ISJSON({文本控件})

结果：true

ISINT({字符})：判断字符内容是否是整数。

示例：ISINT( 2.123 )

结果：false

ISNUMBER({字符})：判断字符内容是否是数字。

示例：ISNUMBER('2.123')

结果：true

GETJSONVALUE({变量1},变量2)：获取JSON值。第一个参数为json，可以是数组也可以是对象；第二个参数为json对象的键值，返回键值对应的值，json为数组时返回的多个值以逗号分隔 。

示例：假设文本控件={a:123}，GetJSONValue('{文本控件}','a')，

结果：123

**比较操作符**

**说明**

比较操作符是指可以使用下列操作符比较两个值。

**函数详情**

＞大于

＞＝ 大于等于

＜ 小于

＜＝小于等于

=  等于

！= 不等于

**日期函数**

**说明**

对日期类型的控件做运算操作。如运算日期的加减、两个日期之间的间隔、取特定日期的年份月份等。

**函数详情**

TODAY()：返回当天日期。

示例：TODAY()

结果： '2020-01-01'

NOW()：返回当天日期+时间。

示例：NOW()

结果：'2016-12-24 12:05:38'

DATEADD(日期,数值,['单位'])：对日期加减按照单位加减。单位默认为日，可选单位：年Y、月M、日D、时H、分I、秒S。

示例1：

DATEADD('2016-12-21', 3)

结果：'2016-12-24'

示例2：

DATEADD('2016-12-24 20:00:00', 3, 'H')

结果：'2016-12-24 23:00:00'

DATEDIFF(日期1,日期2,['单位'])：根据指定的单位，返回日期2减去日期1的差值。当日期2小于日期1时，差值为负值。单位默认为日，可选单位：年Y、月M、日D、时H、分I、秒S。

示例：DATEDIF('2016-12-21', '2016-12-24')

结果： 3 DATEDIF('2016-12-24 20:00:00', '2016-12-25 20:00:00', 'H') 结果： 24

DATEFORMAT(日期,'可选格式')：将日期转为指定格式返回。

示例：DATEFORMAT('2016-12-24', 'YY年MM月DD日')

结果：2016年12月24日 yyyy 将年份显示为1900-9999 yy 将年份显示为00-99 mm 将月份显示为 01–12 dd 将日期显示为 01–31

YEAR(日期)：返回指定日期中的年。

示例：YEAR('2016-12-24')

结果： 2016

MONTH(日期)：返回指定日期中的月。

示例：MONTH('2016-12-24')

结果： 12

DAY(日期)：返回指定日期中的日。

示例：DAY('2016-12-24')

结果： 24

HOUR(日期)：返回指定日期中的小时。

示例：HOUR('2016-12-24 20:30:56')

结果： 20

MINUTE(日期)：返回指定日期中的分钟。

示例：MINUTE('2016-12-24 20:30:56')

结果： 30

SECOND(日期)：返回指定日期中的秒钟。

示例：SECOND('2016-12-24 20:30:56')

结果： 56

WEEKNUM(日期)：返回指定日期为第几周，从每年第1天开始算第1周。

示例：WEEKNUM('2016-12-24')

结果： 52

WEEKDAY(日期)：返回指定日期为星期几。返回值为0~6，代表周日~周六。

示例：WEEKDAY('2016-12-24')

结果： 6

EOMONTH(日期)：返回某月最后一天日期。

示例：EOMONTH('2021-11-07', -2)

结果： 6

NETWORKDAYSPI(日期)：返回截止当前日期之前所选时间段内包含的工作日天数。将截止当前日期之前（支持选到当前日期，最大支持跨度为365天）的所选时间段内包含的工作日天数返回。

注意:此函数只能选择过去的时间（可选到当前日期）才可使用，跨度不能超过365天。当日期2小于日期1时，差值为负值。单位默认为日。

示例：想知道李四在2021-11-07和2021-11-12之间的工作日天数，NETWORKDAYSPI('2021-11-07', '2021-11-12'，'李四')

结果：5

CURRYEAR()：取当前日期的年份。

示例：假设当前时间为：2022年2月17日 11:20:30 ，CURRYEAR()

结果： 2022

CURRMONTH()：取当前日期的月份。

示例：假设当前时间为：2022年2月17日 11:20:30 ，CURRMONTH()

结果： 2

CURRDAY()：取当前日期的天。

示例：假设当前时间为：2022年2月17日 11:20:30 ，CURRDAY()

结果： 17

CURRWEEK()：取当前日期是周几。

示例：假设当前时间为：2022年2月17日 11:20:30 ，CURRWEEK()

结果： 4

CURRHOUR()：取当前日期的小时。

示例：假设当前时间为：2022年2月17日 11:20:30 ，CURRHOUR()

结果： 11

CURRMINUTE()：取当前日期的分钟。

示例：假设当前时间为：2022年2月17日 11:20:30 ，CURRMINUTE()

结果： 20

CURRSECOND()：取当前日期的秒钟。

示例：假设当前时间为：2022年2月17日 11:20:30 ，CURRSECOND()

结果： 30

MAXDATE(日期1，日期2，……)：取一组日期中的最大值。

示例：MAXDATE('2016-12-24', '2022-12-24')

结果： 2022-12-24

MINDATE(日期1，日期2，……)：取一组日期中的最小值。

示例：MINDATE('2016-12-24', '2022-12-24')

结果： 2016-12-24

COMPAREDATE(日期1，日期2，[比较类型])：日期比较，返回两个日期指定时间域的差值。可比较的时间域包括'Y'-比较年;'M'-比较月;'D'-比较日;'H'-比较小时;'I'-比较分钟;'S'-比较秒。

示例：假设 日期1=2022-04-03、日期2=2022-04-04，COMPAREDATE({日期1},{日期2},'D')，

结果：1

**数学函数**

**说明**

对控件的值进行数学运算，常用于金额控件、数字控件。如执行四舍五入、求余等。

**函数详情**

ROUND(数字字段)：四舍五入。根据设置的小数位精确度，返回对数值四舍五入后的值。小数位精确度取值可为正整数，0，负整数。如果小数位精确度为正整数，针对小数点后的数据进行四舍五入；如果小数位精确度等于 0，返回最接近数值的整数；如果小数位精确度为负整数，针对小数点前的数据进行四舍五入，被舍掉的数据用0占位。小数位精确度不支持变量。小数位精确度默认为0，即只保留整数。

示例：ROUND(123.456，2)，ROUND(123.456，0)，ROUND(123.456，-2) ，

结果：依次为123.46，123，100

ROUNDUP(数字字段)：向上舍入。

示例：ROUNDDOWN(76.9,0)

结果：77

ROUNDDOWN(数字字段)：向下舍入。

示例：ROUNDDOWN(76.9,0)

结果：76

AGGERGATION(): 将一组数据进行统计计算，支持最大值（MAX）、最小值（MIN）、平均值（AVG）。

示例：AGGREGATION(1 , 2,3,'AVG')

结果：2

注意：数学函数中的AGGREGATION（聚合运算函数）与聚合函数不同，AGGREGATION做的是一组数字的聚合，不会涉及到跨表单数据，而聚合函数可以涉及多数据源。

MOD(): 将两个参数进行除法运算然后得出余数返回。

示例：MOD( 7 , 3 )

结果：1

TRUNC(): 将小数点格式化成指定位数。

示例：TRUNC( 2.123 , 2 )

结果：2.12

CALDTROW({字段},{公式或字段})：明细逐行计算。

示例：假设：明细有金额1、金额2、金额3等三个控件，明细行数为2，第一行值分别为：5、6、10，第二行的值分别为：1、1、9。

CALDTROW({金额3}==10,{金额1}+{金额2})

结果：当金额3等于10的时候运算加法，只有第一行的金额3等于10，明细第一行的金额3赋值为11

**查找函数**

**说明**

对指定范围内的数据，根据自己的需求找出具体的数据。

**函数详情**

FIND(): 用指定参数去另一个参数列表中查找匹配项，指定参数时，填写1则去第一个参数列表中查找，2则是第二个参数列表里匹配查找第一个参数，成功则返回true，失败返回false。

示例：FIND([1,2,3],[1,2,3,4],1)

结果：true

MATCH(): 返回指定数值在指定数组区域中的位置。

示例：MATCH(15000, [1000, 15000, 2000])

结果：1

CHOOSE(): 返回索引范围内指定的值。

VLOOKUPS(): 按列查找，返回所需值。按列查找，返回所需值。常用于薪酬模块。根据条件获取查询参数所在列的返回参数的值。返回参数可填写多个，用","隔开。若查询不到返回null。

**数据库函数**

**说明**

针对各业务模块的数据，根据自己的需求找出具体的数据。与查找函数不同是，数据库函数的每个函数已经固定好对应的数据源以及相关字段，无需修改。

**函数详情**

GetHRMNAME()：获取指定人员的姓名。

示例：GETHRMNAME({U:张三})  
结果：张三

GetHRMMOBILE()：获取指定人员的手机号码。

示例：GETHRMMOBILE({U:张三})  
结果：13123232323

GETHRMLOGINID({人员})：获取指定人员系统账号。

示例：GETHRMLOGINID({表单.张三})  
结果：'zhangsan@qq.com'

GETHRMWORKCODE({人员}):获取指定人员编号。

示例：GETHRMWORKCODE({表单.张三})  
结果：'A001'

GETHRMMANAGER({人员}})：获取指定人员直接上级。返回值为对应人员直接上级的ID。

示例：GETHRMMANAGER({表单.张三})

结果：'1559563038252396708'

GETHRMEMAIL({人员})：获取指定人员邮箱。

示例：GETHRMEMAIL({表单.张三})  
结果：'2345@163.com'

GETHRMSECLEVEL({人员})：获取指定人员安全级别。

示例：张三安全级别为1；GETHRMSECLEVEL({表单.张三})  
结果：'1'

GETHRMALLMANAGER({人员})：获取指定人员所有上级。存在多个上级时，返回所有上级形成的数组。

示例：GETHRMALLMANAGER({表单.张三})

结果：返回张三的所有上级形成的数组

GETHRMDEPARTMENT({人员})：获取指定人员部门。返回值为部门ID。

示例：GETHRMDEPARTMENT({表单.张三})

结果：'"1560052731319352218"'

GETHRMSUBCOMPANY({人员})：获取指定人员分部。返回值为分部ID。

示例：GETHRMSUBCOMPANY({表单.张三})  
结果：'1560052738'

GETDEPARTMENTNAME({部门})：获取指定部门名称。

示例：GETDEPARTMENTNAME({表单.A部门})  
结果：'A部门'

GETDEPARTMENTCODE({部门})：获取指定部门编号。

示例：GETDEPARTMENTCODE({表单.A部门})  
结果：'A001'

GETSUPERDEPARTMENT({部门})：获取指定部门直接上级部门。返回值为对应部门直接上级部门的ID。

示例：GETDEPARTMENTCODE({表单.A部门})  
结果：'1559563038252396709'

GETALLSUPERDEPARTMENT({部门})：获取指定部门所有上级部门。存在多个上级部门时，返回所有上级部门形成的数组。

示例：GETALLSUPERDEPARTMENT({表单.A部门})  
结果：返回A部门的所有上级部门形成的数组

GETSUBCOMPANYNAME({分部})：获取指定分部名称。

示例：GETSUBCOMPANYNAME({表单.A分部})  
结果：'A分部'

GETSUBCOMPANYCODE({分部})：获取指定分部编号。

示例：GETSUBCOMPANYCODE({表单.A分部})  
结果：'B001'

GETSUPERSUBCOMPANY({分部})：获取指定分部直接上级分部。返回值为对应部门直接上级分部的ID。

示例：GETSUPERSUBCOMPANY({表单.A分部})  
结果：'1559563038252396705'

GETALLSUPERSUBCOMPANY({分部})：获取指定分部所有上级分部。存在多个上级分部时，返回所有上级分部形成的数组。

示例：GETALLSUPERSUBCOMPANY({表单.A分部})  
结果：A分部的所有上级分部形成的数组

GETREQUESTMARK({关联审批})：获取指定审批编号。

示例：假设关联审批=审批数据A，编号为：2332323，GETREQUESTMARK({关联审批})  
结果：'2332323'

GETDOCCODE({关联文档})：获取指定文档编号。

示例：假设关联文档=文档A，文档A编号为：234567，GETDOCCODE({关联文档})  
结果：'234567'

GETPRJCODE({关联项目})：获取指定项目编号。

示例：假设关联项目=项目A，项目A编号为：2838383，GETPRJCODE({关联项目})  
结果：'2838383'

GETCRMCODE({关联客户})：获取指定客户编号。

示例：假设关联客户=客户A，客户A编号为：2838383，GETCRMCODE({关联客户})  
结果：'2838383'

LANGUAGE()：获取当前语言。

示例：LANGUAGE()  
结果：简体中文

GETREQUESTSTATUS()：获取审批状态。

示例：GETREQUESTSTATUS({表单.关联审批})

结果：'审批中'

**财务函数**

**说明**

用于涉及财务相关业务场景下的专用函数。如将数字转化为中文金额大写。

**函数详情**

GetMONEY()：将金额转化成中文金额大写。

示例：GetMoney(1234)

结果：壹仟贰佰叁拾肆元整

**重要说明**

系统中后续更新的函数不在帮助文档中说明，请在公式编辑器中的“提示说明”中了解公式用法。

![](7217b7927307b1966c349d24500cb41a.jpg)